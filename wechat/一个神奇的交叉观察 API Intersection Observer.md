> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/fu6VqPfWn7mB7evopnDeLA)

å‰è¨€
==

å‰ç«¯å¼€å‘è‚¯å®šç¦»ä¸å¼€åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦èƒ½è¢«ç”¨æˆ·çœ‹è§ï¼Œç„¶åå†åŸºäºæ­¤è¿›è¡Œä¸€äº›äº¤äº’ã€‚

> è¿‡å»ï¼Œè¦æ£€æµ‹ä¸€ä¸ªå…ƒç´ æ˜¯å¦å¯è§æˆ–è€…ä¸¤ä¸ªå…ƒç´ æ˜¯å¦ç›¸äº¤å¹¶ä¸å®¹æ˜“ï¼Œå¾ˆå¤šè§£å†³åŠæ³•ä¸å¯é æˆ–æ€§èƒ½å¾ˆå·®ã€‚ç„¶è€Œï¼Œéšç€äº’è”ç½‘çš„å‘å±•ï¼Œè¿™ç§éœ€æ±‚å´ä¸æ—¥ä¿±å¢ï¼Œæ¯”å¦‚ï¼Œä¸‹é¢è¿™äº›æƒ…å†µéƒ½éœ€è¦ç”¨åˆ°ç›¸äº¤æ£€æµ‹ï¼š
> 
> *   å›¾ç‰‡æ‡’åŠ è½½â€”â€”å½“å›¾ç‰‡æ»šåŠ¨åˆ°å¯è§æ—¶æ‰è¿›è¡ŒåŠ è½½
>     
> *   å†…å®¹æ— é™æ»šåŠ¨â€”â€”ä¹Ÿå°±æ˜¯ç”¨æˆ·æ»šåŠ¨åˆ°æ¥è¿‘å†…å®¹åº•éƒ¨æ—¶ç›´æ¥åŠ è½½æ›´å¤šï¼Œè€Œæ— éœ€ç”¨æˆ·æ“ä½œç¿»é¡µï¼Œç»™ç”¨æˆ·ä¸€ç§ç½‘é¡µå¯ä»¥æ— é™æ»šåŠ¨çš„é”™è§‰
>     
> *   æ£€æµ‹å¹¿å‘Šçš„æ›å…‰æƒ…å†µâ€”â€”ä¸ºäº†è®¡ç®—å¹¿å‘Šæ”¶ç›Šï¼Œéœ€è¦çŸ¥é“å¹¿å‘Šå…ƒç´ çš„æ›å…‰æƒ…å†µ
>     
> *   åœ¨ç”¨æˆ·çœ‹è§æŸä¸ªåŒºåŸŸæ—¶æ‰§è¡Œä»»åŠ¡æˆ–æ’­æ”¾åŠ¨ç”»
>     
> 
> è¿‡å»ï¼Œç›¸äº¤æ£€æµ‹é€šå¸¸è¦ç”¨åˆ°äº‹ä»¶ç›‘å¬ï¼Œå¹¶ä¸”éœ€è¦é¢‘ç¹è°ƒç”¨Â `Element.getBoundingClientRect()`Â æ–¹æ³•ä»¥è·å–ç›¸å…³å…ƒç´ çš„è¾¹ç•Œä¿¡æ¯ã€‚äº‹ä»¶ç›‘å¬å’Œè°ƒç”¨Â `Element.getBoundingClientRect()`Â  éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œï¼Œå› æ­¤é¢‘ç¹è§¦å‘ã€è°ƒç”¨å¯èƒ½ä¼šé€ æˆæ€§èƒ½é—®é¢˜ã€‚è¿™ç§æ£€æµ‹æ–¹æ³•æå…¶æ€ªå¼‚ä¸”ä¸ä¼˜é›…ã€‚

ä¸Šé¢è¿™ä¸€æ®µè¯æ¥è‡ªÂ `MDN`Â ï¼Œä¸­å¿ƒæ€æƒ³å°±æ˜¯ç°åœ¨åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦èƒ½è¢«ç”¨æˆ·çœ‹è§çš„ä½¿ç”¨åœºæ™¯è¶Šæ¥è¶Šå¤šï¼Œç›‘å¬Â `scroll`Â äº‹ä»¶ä»¥åŠé€šè¿‡Â `Element.getBoundingClientRect()`Â è·å–èŠ‚ç‚¹ä½ç½®çš„æ–¹å¼ï¼Œåˆéº»çƒ¦åˆä¸å¥½ç”¨ï¼Œé‚£ä¹ˆæ€ä¹ˆåŠå‘¢ã€‚äºæ˜¯å°±æœ‰äº†ä»Šå¤©çš„å†…å®¹Â **Intersection Observer API**ã€‚

Intersection Observer API æ˜¯ä»€ä¹ˆ
=============================

æˆ‘ä»¬éœ€è¦è§‚å¯Ÿçš„å…ƒç´ è¢«ç§°ä¸ºÂ **ç›®æ ‡å…ƒç´  (target)**ï¼Œè®¾å¤‡è§†çª—æˆ–è€…å…¶ä»–æŒ‡å®šçš„å…ƒç´ è§†å£çš„è¾¹ç•Œæ¡†æˆ‘ä»¬ç§°å®ƒä¸ºÂ **æ ¹å…ƒç´ ** (**root**)ï¼Œæˆ–è€…ç®€ç§°ä¸ºÂ **æ ¹**Â ã€‚

`Intersection Observer API`Â ç¿»è¯‘è¿‡æ¥å«åšÂ **â€œäº¤å‰è§‚å¯Ÿå™¨â€**ï¼Œå› ä¸ºåˆ¤æ–­å…ƒç´ æ˜¯å¦å¯è§ï¼ˆ**é€šå¸¸æƒ…å†µä¸‹**ï¼‰çš„æœ¬è´¨å°±æ˜¯åˆ¤æ–­ç›®æ ‡å…ƒç´ å’Œæ ¹å…ƒç´ æ˜¯ä¸æ˜¯äº§ç”Ÿäº†Â **äº¤å‰åŒºåŸŸ**Â ã€‚

ä¸ºä»€ä¹ˆæ˜¯é€šå¸¸æƒ…å†µä¸‹ï¼Œå› ä¸ºå½“æˆ‘ä»¬Â `css`Â è®¾ç½®äº†Â `opacity: 0`ï¼Œ`visibility: hidden`Â æˆ–è€…Â `ç”¨å…¶ä»–çš„å…ƒç´ è¦†ç›–ç›®æ ‡å…ƒç´ `Â çš„æ—¶å€™ï¼Œå¯¹äºè§†å›¾æ¥è¯´æ˜¯ä¸å¯è§çš„ï¼Œä½†å¯¹äºäº¤å‰è§‚å¯Ÿå™¨æ¥è¯´æ˜¯å¯è§çš„ã€‚è¿™é‡Œå¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œå¤§å®¶åªéœ€è®°ä½ï¼Œäº¤å‰è§‚å¯Ÿå™¨åªå…³å¿ƒÂ **ç›®æ ‡å…ƒç´ **Â å’ŒÂ **æ ¹å…ƒç´ **Â æ˜¯å¦æœ‰Â **äº¤å‰åŒºåŸŸ**ï¼Œ è€Œä¸ç®¡è§†è§‰ä¸Šèƒ½ä¸èƒ½çœ‹è§è¿™ä¸ªå…ƒç´ ã€‚å½“ç„¶å¦‚æœè®¾ç½®äº†Â `displayï¼šnone`ï¼Œé‚£ä¹ˆäº¤å‰è§‚å¯Ÿå™¨å°±ä¸ä¼šç”Ÿæ•ˆäº†ï¼Œå…¶å®ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå› ä¸ºå…ƒç´ å·²ç»ä¸å­˜åœ¨äº†ï¼Œé‚£ä¹ˆä¹Ÿå°±ç›‘æµ‹ä¸åˆ°äº†ã€‚

> ä¸€å¥è¯æ€»ç»“ï¼š**Intersection Observer API**Â æä¾›äº†ä¸€ç§å¼‚æ­¥æ£€æµ‹ç›®æ ‡å…ƒç´ ä¸ç¥–å…ˆå…ƒç´ æˆ–Â **viewport**Â ç›¸äº¤æƒ…å†µå˜åŒ–çš„æ–¹æ³•ã€‚Â -- MDN

ç°åœ¨ä¸æ‡‚æ²¡å…³ç³»ï¼Œå’±ä»¬æ¥ç€å¾€ä¸‹çœ‹ï¼Œçœ‹å®Œè‡ªç„¶å°±æ˜ç™½äº†ã€‚

Intersection Observer API æ€ä¹ˆç©
=============================

ç”Ÿæˆè§‚å¯Ÿå™¨
-----

```
//Â è°ƒç”¨æ„é€ å‡½æ•°Â IntersectionObserverÂ ç”Ÿæˆè§‚å¯Ÿå™¨constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options);Â Â å¤åˆ¶ä»£ç 
```

é¦–å…ˆè°ƒç”¨æµè§ˆå™¨åŸç”Ÿæ„é€ å‡½æ•°Â `IntersectionObserver`Â ï¼Œæ„é€ å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªÂ **è§‚å¯Ÿå™¨å®ä¾‹**Â ã€‚

æ„é€ å‡½æ•°Â `IntersectionObserver`Â æ¥æ”¶ä¸¤ä¸ªå‚æ•°

*   **callbackï¼š**Â å¯è§æ€§å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘çš„å›è°ƒå‡½æ•°
    
*   **optionsï¼š**Â é…ç½®å¯¹è±¡ï¼ˆå¯é€‰ï¼Œä¸ä¼ æ—¶ä¼šä½¿ç”¨é»˜è®¤é…ç½®ï¼‰
    

### æ„é€ å‡½æ•°æ¥æ”¶çš„å‚æ•° options

ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘ä»¬å…ˆçœ‹ç¬¬äºŒä¸ªå‚æ•°Â `options`Â ã€‚ä¸€ä¸ªå¯ä»¥ç”¨æ¥é…ç½®è§‚å¯Ÿå™¨å®ä¾‹çš„å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªé…ç½®å¯¹è±¡éƒ½åŒ…å«å“ªäº›å±æ€§å‘¢ï¼Ÿ

*   **rootï¼š**Â è®¾ç½®ç›®æ ‡å…ƒç´ çš„æ ¹å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç”¨æ¥åˆ¤æ–­å…ƒç´ æ˜¯å¦å¯è§çš„åŒºåŸŸï¼Œå¿…é¡»æ˜¯ç›®æ ‡å…ƒç´ çš„çˆ¶çº§å…ƒç´ ï¼Œå¦‚æœä¸æŒ‡å®šçš„è¯ï¼Œåˆ™ä½¿ç”¨æµè§ˆå™¨è§†çª—ï¼Œä¹Ÿå°±æ˜¯Â `document`ã€‚
    
*   **rootMarginï¼š**Â ä¸€ä¸ªåœ¨è®¡ç®—äº¤å‰å€¼æ—¶æ·»åŠ è‡³æ ¹çš„è¾¹ç•Œä¸­çš„ä¸€ç»„åç§»é‡ï¼Œç±»å‹ä¸ºå­—ç¬¦ä¸²Â `(string)`Â Â ï¼Œå¯ä»¥æœ‰æ•ˆçš„ç¼©å°æˆ–æ‰©å¤§æ ¹çš„åˆ¤å®šèŒƒå›´ä»è€Œæ»¡è¶³è®¡ç®—éœ€è¦ã€‚è¯­æ³•å¤§è‡´å’Œ CSS ä¸­Â `margin`Â å±æ€§ç­‰åŒï¼Œé»˜è®¤å€¼Â `â€œ0px 0px 0px 0pxâ€`Â ï¼Œå¦‚æœæœ‰æŒ‡å®šÂ `root`Â å‚æ•°ï¼Œåˆ™Â `rootMargin`Â ä¹Ÿå¯ä»¥ä½¿ç”¨ç™¾åˆ†æ¯”æ¥å–å€¼ã€‚
    
*   **thresholdï¼š**Â ä»‹äºÂ `0`Â å’ŒÂ `1`Â ä¹‹é—´çš„æ•°å­—ï¼ŒæŒ‡ç¤ºè§¦å‘å‰åº”å¯è§çš„ç™¾åˆ†æ¯”ã€‚ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ•°å­—æ•°ç»„ï¼Œä»¥åˆ›å»ºå¤šä¸ªè§¦å‘ç‚¹ï¼Œä¹Ÿè¢«ç§°ä¹‹ä¸ºÂ **é˜ˆå€¼**ã€‚å¦‚æœæ„é€ å™¨æœªä¼ å…¥å€¼, åˆ™é»˜è®¤å€¼ä¸ºÂ `0`Â ã€‚
    
*   **trackVisibilityï¼š**Â ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤ºå½“å‰è§‚å¯Ÿå™¨æ˜¯å¦å°†è·Ÿè¸ªç›®æ ‡å¯è§æ€§çš„æ›´æ”¹ï¼Œé»˜è®¤ä¸ºÂ `false`Â ï¼Œæ³¨æ„ï¼Œæ­¤å¤„çš„å¯è§æ€§å¹¶éæŒ‡ç›®æ ‡å…ƒç´ å’Œæ ¹å…ƒç´ æ˜¯å¦ç›¸äº¤ï¼Œè€Œæ˜¯æŒ‡è§†å›¾ä¸Šæ˜¯å¦å¯è§ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¹‹å‰å°±å·²ç»åˆ†æè¿‡äº†ï¼Œå¦‚æœæ­¤å€¼è®¾ç½®ä¸ºÂ `false`Â æˆ–ä¸è®¾ç½®ï¼Œé‚£ä¹ˆå›è°ƒå‡½æ•°å‚æ•°ä¸­Â `IntersectionObserverEntry`Â çš„Â `isVisible`Â å±æ€§å°†æ°¸è¿œè¿”å›Â `false`Â ã€‚
    
*   **delayï¼š**Â ä¸€ä¸ªæ•°å­—ï¼Œä¹Ÿå°±æ˜¯å›è°ƒå‡½æ•°æ‰§è¡Œçš„å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ã€‚å¦‚æœÂ `trackVisibility`Â è®¾ç½®ä¸ºÂ `true`ï¼Œåˆ™æ­¤å€¼å¿…é¡»è‡³å°‘è®¾ç½®ä¸ºÂ `100`Â ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼ˆä½†æ˜¯è¿™é‡Œæˆ‘ä¹Ÿåªæ˜¯äº²æµ‹å‡ºæ¥çš„ï¼Œå¹¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šè®¾è®¡æˆè¿™æ ·ï¼Œå¦‚æœæœ‰å¤§ä½¬äº†è§£è¯·æŒ‡æ•™ä¸€ä¸‹ï¼‰ã€‚
    

### æ„é€ å‡½æ•°æ¥æ”¶çš„å‚æ•° callback

å½“å…ƒç´ å¯è§æ¯”ä¾‹è¶…è¿‡æŒ‡å®šé˜ˆå€¼åï¼Œä¼šè°ƒç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ­¤å›è°ƒå‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šå­˜æ”¾Â `IntersectionObserverEntry`Â å¯¹è±¡çš„æ•°ç»„å’Œè§‚å¯Ÿå™¨å®ä¾‹ (å¯é€‰)ã€‚

```
((doc)Â =>Â {Â Â //å›è°ƒå‡½æ•°Â Â constÂ callbackÂ =Â (entries,Â observer)Â =>Â {Â Â Â Â console.log('ğŸš€ğŸš€~Â æ‰§è¡Œäº†ä¸€æ¬¡callback');Â Â Â Â console.log('ğŸš€ğŸš€~Â entries:',Â entries);Â Â Â Â console.log('ğŸš€ğŸš€~Â observer:',Â observer);Â Â };Â Â //é…ç½®å¯¹è±¡Â Â constÂ optionsÂ =Â {};Â Â //åˆ›å»ºè§‚å¯Ÿå™¨Â Â constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options);Â Â //è·å–ç›®æ ‡å…ƒç´ Â Â constÂ targetÂ =Â doc.querySelector(".target")Â Â //å¼€å§‹ç›‘å¬ç›®æ ‡å…ƒç´ Â Â myObserver.observe(target);})(document)
```

æˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ªå‚æ•°æ‰“å°å‡ºæ¥çœ‹ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªç›®æ ‡å…ƒç´ å¯¹åº”çš„Â `IntersectionObserverEntry`å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è§‚å¯Ÿå™¨å®ä¾‹å¯¹è±¡Â `IntersectionObserver`Â ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79mWXxicN4g8mQJftHDjoTDNZhYjZ7taicn6DGEWNQ5GJDcenibcaX01FDQ/640?wx_fmt=jpeg)

#### ä»€ä¹ˆæ˜¯ IntersectionObserverEntry å¯¹è±¡

å±•å¼€Â `IntersectionObserverEntry`Â çœ‹ä¸€ä¸‹éƒ½æœ‰ä»€ä¹ˆã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79nLk25ZXY2lZbz3LXb6tF9oibtPp1FDTPGhsI2ibNknLI4e6XDnqLGzjg/640?wx_fmt=jpeg)

*   **boundingClientRectï¼š**Â ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ç›®æ ‡å…ƒç´ çš„Â `getBoundingClientRect()`Â æ–¹æ³•çš„è¿”å›å€¼ã€‚
    
*   **intersectionRatioï¼š**Â ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ç›®æ ‡å…ƒç´ ä¸æ ¹å…ƒç´ äº¤å‰åŒºåŸŸÂ `getBoundingClientRect()`Â çš„è¿”å›å€¼ã€‚
    
*   **intersectionRectï¼š**Â ç›®æ ‡å…ƒç´ çš„å¯è§æ¯”ä¾‹ï¼Œå³Â `intersectionRect`Â å Â `boundingClientRect`Â çš„æ¯”ä¾‹ï¼Œå®Œå…¨å¯è§æ—¶ä¸ºÂ `1`Â ï¼Œå®Œå…¨ä¸å¯è§æ—¶å°äºç­‰äºÂ `0`Â ã€‚
    
*   **isIntersectingï¼š**Â è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦‚æœç›®æ ‡å…ƒç´ ä¸æ ¹å…ƒç´ ç›¸äº¤ï¼Œåˆ™è¿”å›Â `true`Â ï¼Œå¦‚æœÂ `isIntersecting`Â æ˜¯Â `true`ï¼Œåˆ™Â `target`Â å…ƒç´ è‡³å°‘å·²ç»è¾¾åˆ°Â `thresholds`Â å±æ€§å€¼å½“ä¸­è§„å®šçš„å…¶ä¸­ä¸€ä¸ªé˜ˆå€¼ï¼Œå¦‚æœæ˜¯Â `false`ï¼Œ`target`Â å…ƒç´ ä¸åœ¨ç»™å®šçš„é˜ˆå€¼èŒƒå›´å†…å¯è§ã€‚
    
*   **isVisibleï¼š**Â è¿™ä¸ªçœ‹å­—é¢æ„æ€åº”è¯¥æ˜¯Â **â€œæ˜¯å¦å¯è§â€**Â ï¼Œå¦‚æœè¦è®©è¿™ä¸ªå±æ€§ç”Ÿæ•ˆï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨æ„é€ å‡½æ•°ç”Ÿæˆè§‚å¯Ÿå™¨å®ä¾‹çš„æ—¶å€™ï¼Œä¼ å…¥çš„Â `options`Â å‚æ•°å¿…é¡»é…ç½®Â `trackVisibility`Â ä¸ºÂ `true`ï¼Œå¹¶ä¸”Â `delay`Â è®¾ç½®ä¸ºå¤§äºÂ `100`Â ï¼Œå¦åˆ™è¯¥å±æ€§å°†æ°¸è¿œè¿”å›Â `false`Â ã€‚
    
*   **rootBoundsï¼š**Â ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«æ ¹å…ƒç´ çš„Â `getBoundingClientRect()`Â æ–¹æ³•çš„è¿”å›å€¼ã€‚
    
*   **targetï¼šï¼š**Â è¢«è§‚å¯Ÿçš„ç›®æ ‡å…ƒç´ ï¼Œæ˜¯ä¸€ä¸ªÂ `DOM`Â èŠ‚ç‚¹ã€‚åœ¨è§‚å¯Ÿè€…åŒ…å«å¤šä¸ªç›®æ ‡çš„æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ç¡®å®šå“ªä¸ªç›®æ ‡å…ƒç´ è§¦å‘äº†æ­¤ç›¸äº¤æ›´æ”¹çš„ç®€ä¾¿æ–¹æ³•ã€‚
    
*   **timeï¼š**Â è¯¥å±æ€§æä¾›ä»Â **é¦–æ¬¡åˆ›å»ºè§‚å¯Ÿè€…**Â åˆ°Â **è§¦å‘æ­¤äº¤é›†æ”¹å˜**Â çš„æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥è·Ÿè¸ªè§‚å¯Ÿå™¨è¾¾åˆ°ç‰¹å®šé˜ˆå€¼æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚å³ä½¿ç¨åå°†ç›®æ ‡å†æ¬¡æ»šåŠ¨åˆ°è§†å›¾ä¸­ï¼Œæ­¤å±æ€§ä¹Ÿä¼šæä¾›æ–°çš„æ—¶é—´ã€‚è¿™å¯ç”¨äºè·Ÿè¸ªç›®æ ‡å…ƒç´ è¿›å…¥å’Œç¦»å¼€æ ¹å…ƒç´ çš„æ—¶é—´ï¼Œä»¥åŠä¸¤ä¸ªé˜ˆå€¼è§¦å‘çš„é—´éš”æ—¶é—´ã€‚
    

è¿™é‡Œå†çœ‹ä¸€ä¸‹Â **boundingClientRect**Â ï¼Œ**intersectionRatio**Â ï¼ŒÂ **rootBounds**Â ä¸‰ä¸ªå±æ€§å±•å¼€çš„å†…å®¹éƒ½æœ‰ä»€ä¹ˆã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79mCbFINic5SbLND5ib1Xjj4ytRlwQGjE7EV1LfSxK2zKC47b7Epq0CllQ/640?wx_fmt=jpeg)

*   **bottomï¼š**Â å…ƒç´ ä¸‹è¾¹è·ç¦»é¡µé¢ä¸Šè¾¹çš„è·ç¦»
    
*   **leftï¼š**Â å…ƒç´ å·¦è¾¹è·ç¦»é¡µé¢å·¦è¾¹çš„è·ç¦»
    
*   **rightï¼š**Â å…ƒç´ å³è¾¹è·ç¦»é¡µé¢å·¦è¾¹çš„è·ç¦»
    
*   **topï¼š**Â å…ƒç´ ä¸Šè¾¹è·ç¦»é¡µé¢ä¸Šè¾¹çš„è·ç¦»
    
*   **widthï¼š**Â å…ƒç´ çš„å®½
    
*   **heightï¼š**Â å…ƒç´ çš„é«˜
    
*   **xï¼š**Â ç­‰åŒäºÂ `left`ï¼Œå…ƒç´ å·¦è¾¹è·ç¦»é¡µé¢å·¦è¾¹çš„è·ç¦»
    
*   **yï¼š**Â ç­‰åŒäºÂ `top`ï¼Œå…ƒç´ ä¸Šè¾¹è·ç¦»é¡µé¢ä¸Šè¾¹çš„è·ç¦»
    

ç”¨ä¸€å¼ å›¾æ¥å±•ç¤ºä¸€ä¸‹è¿™å‡ ä¸ªå±æ€§ï¼Œç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯Â `right`Â å’ŒÂ `bottom`Â ï¼Œè·Ÿæˆ‘ä»¬å¹³æ—¶å†™Â `css`Â çš„Â `position`Â é‚£ä¸ªä¸ä¸€æ · ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79k7FWLUichicuEnDQ19licopy1vtPczxHfxZjYIoNWicCKyCmNB9V9P8B6A/640?wx_fmt=jpeg)

#### é‚£ä¹ˆç¬¬äºŒä¸ªå‚æ•° IntersectionObserver è§‚å¯Ÿå™¨å®ä¾‹å¯¹è±¡éƒ½æœ‰ä»€ä¹ˆå‘¢

åˆ«ç€æ€¥ï¼Œæ¥ç€å¾€ä¸‹çœ‹ï¼Œå®ä¾‹å±æ€§éƒ¨åˆ†ã€‚

è§‚å¯Ÿå™¨å®ä¾‹å±æ€§
-------

ä¸Šé¢ç•™äº†ä¸€ä¸ªå‘ï¼Œå›è°ƒå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°Â `IntersectionObserver`Â è§‚å¯Ÿå™¨å®ä¾‹å¯¹è±¡éƒ½æœ‰ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬æŠŠå®ä¾‹å¯¹è±¡æ‰“å°å‡ºæ¥çœ‹ä¸€ä¸‹

```
((doc)Â =>Â {Â Â //å›è°ƒå‡½æ•°Â Â constÂ callbackÂ =Â ()Â =>Â {};Â Â //é…ç½®å¯¹è±¡Â Â constÂ optionsÂ =Â {};Â Â //åˆ›å»ºè§‚å¯Ÿå™¨Â Â constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options);Â Â //è·å–ç›®æ ‡å…ƒç´ Â Â constÂ targetÂ =Â doc.querySelector(".target")Â Â //å¼€å§‹ç›‘å¬ç›®æ ‡å…ƒç´ Â Â myObserver.observe(target);Â Â console.log('ğŸš€ğŸš€~Â myObserver:',Â myObserver);})(document)
```

![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79NrAIPgrEbauto0o2nTcIJzmtOzYic0oA7c2YpLEer3sFbJo1gbXCMiaA/640?wx_fmt=jpeg)å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„è§‚å¯Ÿå™¨å®ä¾‹ä¸Šé¢åŒ…å«å¦‚ä¸‹å±æ€§

*   **root**
    
*   **rootMargin**
    
*   **thresholds**
    
*   **trackVisibility**
    
*   **delay**
    

æ˜¯ä¸æ˜¯ç‰¹åˆ«çœ¼ç†Ÿï¼Œæ²¡é”™ï¼Œå°±æ˜¯æˆ‘ä»¬åˆ›å»ºè§‚å¯Ÿè€…å®ä¾‹çš„æ—¶å€™ï¼Œä¼ å…¥çš„Â `options`Â å¯¹è±¡ï¼Œåªä¸è¿‡Â `options`Â å¯¹è±¡æ˜¯å¯é€‰çš„ï¼Œè§‚å¯Ÿå™¨å®ä¾‹çš„å±æ€§å°±ä½¿ç”¨æˆ‘ä»¬ä¼ å…¥çš„Â `options`Â å¯¹è±¡ï¼Œå¦‚æœæ²¡ä¼ å°±ä½¿ç”¨é»˜è®¤å€¼ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œ`options`Â ä¸­ çš„å±æ€§Â `threshold`Â æ˜¯å•æ•°ï¼Œè€Œæˆ‘ä»¬å®ä¾‹è·å–åˆ°çš„Â `thresholds`Â æ˜¯å¤æ•°ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„æ‰€æœ‰å±æ€§éƒ½æ˜¯Â **åªè¯»**Â çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€æ—¦è§‚å¯Ÿå™¨è¢«åˆ›å»ºï¼Œåˆ™Â **æ— æ³•**Â æ›´æ”¹å…¶é…ç½®ï¼Œæ‰€ä»¥ä¸€ä¸ªç»™å®šçš„è§‚å¯Ÿè€…å¯¹è±¡åªèƒ½ç”¨æ¥ç›‘å¬å¯è§åŒºåŸŸçš„ç‰¹å®šå˜åŒ–å€¼ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬å°±é€šè¿‡ä»£ç ç»“åˆåŠ¨å›¾æ¼”ç¤ºä¸€ä¸‹è¿™äº›å±æ€§

```
((doc)Â =>Â {Â Â letÂ nÂ =Â 0Â Â //è·å–ç›®æ ‡å…ƒç´ Â Â constÂ targetÂ =Â doc.querySelector(".target")Â Â //è·å–æ ¹å…ƒç´ Â Â constÂ rootÂ =Â doc.querySelector(".out-container")Â Â //å›è°ƒå‡½æ•°Â Â constÂ callbackÂ =Â (entries,Â observer)Â =>Â {Â Â Â Â n++Â Â Â Â console.log(`ğŸš€ğŸš€~Â æ‰§è¡Œäº†Â ${n}Â æ¬¡callback`);Â Â Â Â console.log('ğŸš€ğŸš€~Â entries:',Â entries);Â Â Â Â console.log('ğŸš€ğŸš€~Â observer:',Â observer);Â Â };Â Â //é…ç½®å¯¹è±¡Â Â constÂ optionsÂ =Â {Â Â Â Â root:Â root,Â Â Â Â rootMargin:Â '0pxÂ 0pxÂ 0pxÂ 0px',Â Â Â Â threshold:Â [0.5],Â Â Â Â trackVisibility:Â true,Â Â Â Â delay:Â 100Â Â };Â Â //åˆ›å»ºè§‚å¯Ÿå™¨Â Â constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options);Â Â //å¼€å§‹ç›‘å¬ç›®æ ‡å…ƒç´ Â Â myObserver.observe(target);Â Â console.log('ğŸš€ğŸš€~Â myObserver:',Â myObserver);})(document)
```

**root** è¿™ä¸ªæ²¡ä»€ä¹ˆè¯´çš„ï¼Œå°±æ˜¯è®¾ç½®æŒ‡å®šèŠ‚ç‚¹ä¸ºæ ¹å…ƒç´ ![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79y6nS0iawM2qB6bMmO3bPsoSvOq6ib50jjy1qPG3FXtoecgIjpc3EDiaYg/640?wx_fmt=jpeg) **rootMargin** æˆ‘ä»¬æŠŠÂ `rootMargin`Â ä¿®æ”¹ä¸ºÂ `'50px 50px 50px 50px'`ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å…ƒç´ è¿˜æ²¡æœ‰éœ²å‡ºæ¥çš„æ—¶å€™å›è°ƒå‡½æ•°å°±å·²ç»æ‰§è¡Œäº†ï¼Œä¹Ÿå°±æ˜¯è¯´ç›®æ ‡å…ƒç´ è·ç¦»æ ¹å…ƒç´ è¿˜æœ‰Â `50px`Â çš„Â `margin`Â æ—¶ï¼Œè§‚å¯Ÿå™¨å°±è®¤ä¸ºæ˜¯å‘ç”Ÿäº†äº¤å‰ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79mGcds6h7UlZiakX6ATrhsnM3PFp8H6e6I6CSsgjw5GpUZBkMOtS6X4A/640?wx_fmt=jpeg)**thresholds** æˆ‘ä»¬æŠŠÂ `threshold`Â ä¿®æ”¹ä¸ºÂ `[0.1, 0.3, 0.5, 0.8, 1]`, å¯ä»¥çœ‹åˆ°ï¼Œå›è°ƒå‡½æ•°è§¦å‘äº†å¤šæ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´å½“äº¤å‰åŒºåŸŸçš„ç™¾åˆ†æ¯”ï¼Œæ¯è¾¾åˆ°æŒ‡å®šçš„é˜ˆå€¼æ—¶éƒ½ä¼šè§¦å‘ä¸€æ¬¡å›è°ƒå‡½æ•°ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79eNCX5xM0bSSEDB4MSaEGOdVY47mdiapdbaFt1djj8xRxvJaboibHwD2w/640?wx_fmt=jpeg)

> æ³¨æ„Â `Intersection Observer API`Â æ— æ³•æä¾›é‡å çš„åƒç´ ä¸ªæ•°æˆ–è€…å…·ä½“å“ªä¸ªåƒç´ é‡å ï¼Œä»–çš„æ›´å¸¸è§çš„ä½¿ç”¨æ–¹å¼æ˜¯â€”â€”å½“ä¸¤ä¸ªå…ƒç´ ç›¸äº¤æ¯”ä¾‹åœ¨Â `N%`Â å·¦å³æ—¶ï¼Œè§¦å‘å›è°ƒï¼Œä»¥æ‰§è¡ŒæŸäº›é€»è¾‘ã€‚Â -- MDN

**trackVisibility** ä¿®æ”¹Â `trackVisibility`Â ä¸ºÂ `true`Â ï¼Œå¯ä»¥çœ‹åˆ°ï¼ŒÂ `isVisible`Â å±æ€§å€¼ä¸ºÂ `true`Â ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79qnLKjeWib3pRKF7SecGOZAtrtF8lRro4TjD88DIhliceibrdFIgibzyu8Q/640?wx_fmt=jpeg)ä¿®æ”¹Â `css`Â å±æ€§ ä¸ºÂ `opacity: 0`ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æˆ‘ä»¬è“è‰²å°æ–¹å—å¹¶æ²¡æœ‰å‡ºç°åœ¨è§†å›¾ä¸­ï¼Œä½†æ˜¯å›è°ƒå‡½æ•°å·²ç»æ‰§è¡Œäº†ï¼Œå¹¶ä¸”Â `isVisible`Â å±æ€§å€¼ä¸ºÂ `false`Â è€ŒÂ `isIntersecting`Â å€¼ä¸ºÂ `true`Â ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79icZrHxsuSBr8d22ibTQvecZu8xNPiaUJ9n0pNBBNkKBQiaFXgaeMClibQuA/640?wx_fmt=jpeg)**delay** å›è°ƒå‡½æ•°å»¶è¿Ÿè§¦å‘ï¼Œæˆ‘ä»¬ä¿®æ”¹Â `delay`Â ä¸ºÂ `3000`ï¼Œå¯ä»¥çœ‹åˆ°Â `log`Â æ˜¯Â `3000ms`Â ä»¥åæ‰è¾“å‡ºçš„ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79VcP51TNVPg8SSiaSDIicjsH7WkVWRdaQ6sruJ0hSNliab9oIS2FWG0ZibA/640?wx_fmt=jpeg)

è§‚å¯Ÿå™¨å®ä¾‹æ–¹æ³•
-------

é€šè¿‡æ­¤æ®µä»£ç æ¥æ¼”ç¤ºè§‚å¯Ÿå™¨å®ä¾‹æ–¹æ³•ï¼Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œæˆ‘æ·»åŠ äº†å‡ ä¸ªå¯¹åº”çš„æŒ‰é’®ã€‚

```
((doc)Â =>Â {Â Â letÂ nÂ =Â 0Â Â //è·å–ç›®æ ‡å…ƒç´ Â Â constÂ target1Â =Â doc.querySelector(".target1")Â Â constÂ target2Â =Â doc.querySelector(".target2")Â Â //æ·»åŠ å‡ ä¸ªæŒ‰é’®æ–¹ä¾¿æ“ä½œÂ Â constÂ observeÂ =Â doc.querySelector(".observe")Â Â constÂ unobserveÂ =Â doc.querySelector(".unobserve")Â Â constÂ disconnectÂ =Â doc.querySelector(".disconnect")Â Â observe.addEventListener('click',Â ()Â =>Â myObserver.observe(target1))Â Â unobserve.addEventListener('click',Â ()Â =>Â myObserver.unobserve(target1))Â Â disconnect.addEventListener('click',Â ()Â =>Â myObserver.disconnect())Â Â //è·å–æ ¹å…ƒç´ Â Â constÂ rootÂ =Â doc.querySelector(".out-container")Â Â //å›è°ƒå‡½æ•°Â Â constÂ callbackÂ =Â (entries,Â observer)Â =>Â {Â Â Â Â n++Â Â Â Â console.log(`ğŸš€ğŸš€~Â æ‰§è¡Œäº†Â ${n}Â æ¬¡callback`);Â Â Â Â console.log('ğŸš€ğŸš€~Â entries:',Â entries);Â Â Â Â console.log('ğŸš€ğŸš€~Â observer:',Â observer);Â Â };Â Â //é…ç½®å¯¹è±¡Â Â constÂ optionsÂ =Â {Â Â Â Â root:Â root,Â Â Â Â rootMargin:Â '0pxÂ 0pxÂ 0pxÂ 0px',Â Â Â Â threshold:Â [0.1,Â 0.2,Â 0.3,Â 0.5],Â Â Â Â trackVisibility:Â true,Â Â Â Â delay:Â 100Â Â };Â Â //åˆ›å»ºè§‚å¯Ÿå™¨Â Â constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options);Â Â //å¼€å§‹ç›‘å¬ç›®æ ‡å…ƒç´ Â Â myObserver.observe(target2);Â Â console.log('ğŸš€ğŸš€~Â myObserver:',Â myObserver);})(document)
```

### observe

```
constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options);Â myObserver.observe(target);
```

æ¥å—ä¸€ä¸ªç›®æ ‡å…ƒç´ ä½œä¸ºå‚æ•°ã€‚å¾ˆå¥½ç†è§£ï¼Œå½“æˆ‘ä»¬åˆ›å»ºå®Œè§‚å¯Ÿå™¨å®ä¾‹åï¼Œè¦æ‰‹åŠ¨çš„è°ƒç”¨Â `observe`Â æ–¹æ³•æ¥é€šçŸ¥å®ƒå¼€å§‹ç›‘æµ‹ç›®æ ‡å…ƒç´ ã€‚

**å¯ä»¥åœ¨åŒä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡ä¸­é…ç½®ç›‘å¬å¤šä¸ªç›®æ ‡å…ƒç´ **

`target2`Â å…ƒç´ æ˜¯é€šè¿‡ä»£ç è‡ªåŠ¨ç›‘æµ‹çš„ï¼Œè€ŒÂ `target1`Â åˆ™æ˜¯æˆ‘ä»¬åœ¨ç‚¹å‡»äº†Â `observe`Â æŒ‰é’®ä¹‹åå¼€å§‹ç›‘æµ‹çš„ã€‚é€šè¿‡åŠ¨å›¾å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘å•å‡»Â `observe`Â æŒ‰é’®åï¼Œæˆ‘ä»¬çš„Â `entries`Â æ•°ç»„é‡Œé¢å°±åŒ…å«äº†ä¸¤æ¡æ•°æ®ï¼Œå‰æ–‡ä¸­è¯´åˆ°ï¼Œå¯ä»¥é€šè¿‡Â `target`Â å±æ€§æ¥åˆ¤æ–­æ˜¯å“ªä¸ªç›®æ ‡å…ƒç´ ã€‚

![](https://mmbiz.qpic.cn/mmbiz_gif/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79Dap9lLcI40J15PR5aAhFQchw59LEBwyAB5aMI3xEX6MYFYsBo8348A/640?wx_fmt=gif)

### unobserve  

```
constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options);Â myObserver.observe(target);Â myObserver.unobserve(target)å¤åˆ¶ä»£ç 
```

æ¥æ”¶ä¸€ä¸ªç›®æ ‡å…ƒç´ ä½œä¸ºå‚æ•°ï¼Œå½“æˆ‘ä»¬ä¸æƒ³ç›‘å¬æŸä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨Â `unobserve`Â æ–¹æ³•æ¥åœæ­¢ç›‘å¬æŒ‡å®šç›®æ ‡å…ƒç´ ã€‚é€šè¿‡åŠ¨å›¾å¯ä»¥å‘ç°ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»Â `unobserve`Â æŒ‰é’®åï¼Œç”±ä¸¤æ¡æ•°æ®å˜æˆäº†ä¸€æ¡æ•°æ®ï¼Œè¯´æ˜Â `target1`Â å·²ç»ä¸å†æ¥å—ç›‘æµ‹äº†ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79FLk4V4XKVjL8MOTGcnqZVBKeibmg8yLra0EqKDdzSlGibQzHn7DSl2rA/640?wx_fmt=jpeg)

### disconnect

```
constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options);Â myObserver.disconnect()
```

å½“æˆ‘ä»¬ä¸æƒ³ç›‘æµ‹ä»»ä½•ä¸€ä¸ªç›®æ ‡å…ƒç´ æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è°ƒç”¨Â `disconnect`Â æ–¹æ³•åœæ­¢ç›‘å¬å·¥ä½œã€‚é€šè¿‡åŠ¨å›¾å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»Â `disconnect`Â æŒ‰é’®åï¼Œæ§åˆ¶å°ä¸å†è¾“å‡ºÂ `log`Â ï¼Œè¯´æ˜ç›‘å¬å·¥ä½œå·²ç»åœæ­¢ï¼Œå¯ä»¥é€šè¿‡Â `observe`Â å†æ¬¡å¼€å¯ç›‘å¬å·¥ä½œã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79cibuJX2o63wG8jnTta8wg6WYpswu6o4SM24yfB39ibFfw9TzabqIuIag/640?wx_fmt=jpeg)

### takeRecords

è¿”å›æ‰€æœ‰è§‚å¯Ÿç›®æ ‡çš„Â `IntersectionObserverEntry`Â å¯¹è±¡æ•°ç»„ï¼Œåº”ç”¨åœºæ™¯è¾ƒå°‘ã€‚

å½“è§‚å¯Ÿåˆ°äº¤äº’åŠ¨ä½œå‘ç”Ÿæ—¶ï¼Œå›è°ƒå‡½æ•°å¹¶ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨ç©ºé—²æ—¶æœŸä½¿ç”¨Â `requestIdleCallback`Â æ¥å¼‚æ­¥æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œä½†æ˜¯ä¹Ÿæä¾›äº†åŒæ­¥è°ƒç”¨çš„Â `takeRecords`Â æ–¹æ³•ã€‚

å¦‚æœå¼‚æ­¥çš„å›è°ƒå…ˆæ‰§è¡Œäº†ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬è°ƒç”¨åŒæ­¥çš„Â `takeRecords`Â æ–¹æ³•æ—¶ä¼šè¿”å›ç©ºæ•°ç»„ã€‚åŒç†ï¼Œå¦‚æœå·²ç»é€šè¿‡Â `takeRecords`Â è·å–äº†æ‰€æœ‰çš„è§‚å¯Ÿè€…å®ä¾‹ï¼Œé‚£ä¹ˆå›è°ƒå‡½æ•°å°±ä¸ä¼šè¢«æ‰§è¡Œäº†ã€‚

æ³¨æ„äº‹é¡¹
====

æ„é€ å‡½æ•° IntersectionObserverÂ é…ç½®çš„å›è°ƒå‡½æ•°éƒ½åœ¨å“ªäº›æƒ…å†µä¸‹è¢«è°ƒç”¨?
--------------------------------------------

æ„é€ å‡½æ•°Â `IntersectionObserver`Â é…ç½®çš„å›è°ƒå‡½æ•°ï¼Œåœ¨ä»¥ä¸‹æƒ…å†µå‘ç”Ÿæ—¶å¯èƒ½ä¼šè¢«è°ƒç”¨

*   å½“ç›®æ ‡ï¼ˆ**target**ï¼‰å…ƒç´ ä¸æ ¹ï¼ˆ**root**ï¼‰å…ƒç´ å‘ç”Ÿäº¤é›†çš„æ—¶å€™æ‰§è¡Œã€‚
    
*   ä¸¤ä¸ªå…ƒç´ çš„ç›¸äº¤éƒ¨åˆ†å¤§å°å‘ç”Ÿå˜åŒ–æ—¶ã€‚
    
*   `Observer`Â ç¬¬ä¸€æ¬¡ç›‘å¬ç›®æ ‡å…ƒç´ çš„æ—¶å€™ã€‚
    

```
((doc)Â =>Â {Â Â //å›è°ƒå‡½æ•°Â Â constÂ callbackÂ =Â ()Â =>Â {Â Â Â Â console.log('ğŸš€ğŸš€~Â æ‰§è¡Œäº†ä¸€æ¬¡callback');Â Â };Â Â //é…ç½®å¯¹è±¡Â Â constÂ optionsÂ =Â {};Â Â //è§‚å¯Ÿå™¨å®ä¾‹Â Â constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options);Â Â //ç›®æ ‡å…ƒç´ Â Â constÂ targetÂ =Â doc.querySelector("#target")Â Â //å¼€å§‹è§‚å¯ŸÂ Â myObserver.observe(target);})(document)
```

å¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºç›®æ ‡å…ƒç´ æ˜¯å¦ä¸æ ¹å…ƒç´ ç›¸äº¤ï¼Œå½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡ç›‘å¬ç›®æ ‡å…ƒç´ çš„æ—¶å€™ï¼Œå›è°ƒå‡½æ•°éƒ½ä¼šè§¦å‘ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸è¦ç›´æ¥åœ¨å›è°ƒå‡½æ•°é‡Œå†™é€»è¾‘ä»£ç ï¼Œå°½é‡é€šè¿‡Â `isIntersecting`Â æˆ–è€…Â `intersectionRect`Â è¿›è¡Œåˆ¤æ–­ä¹‹åå†æ‰§è¡Œé€»è¾‘ä»£ç ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79QEZR6QstpbMKCyNt1dZEB1ScT2eoRGbhM37FVY4df3Mk9yWbrkibZtw/640?wx_fmt=jpeg)

é¡µé¢çš„å¯è§æ€§å¦‚ä½•ç›‘æµ‹
----------

é¡µé¢çš„å¯è§æ€§å¯ä»¥é€šè¿‡`document.visibilityState`æˆ–è€…`document.hidden`è·å¾—ã€‚é¡µé¢å¯è§æ€§çš„å˜åŒ–å¯ä»¥é€šè¿‡`document.visibilitychange`æ¥ç›‘å¬ã€‚

å¯è§æ€§å’Œäº¤å‰è§‚å¯Ÿ
--------

å½“Â `css`Â è®¾ç½®äº†`opacity: 0`ï¼Œ`visibility: hidden`Â ä»¥åŠÂ `ç”¨å…¶ä»–çš„å…ƒç´ è¦†ç›–ç›®æ ‡å…ƒç´ `Â ï¼Œéƒ½ä¸ä¼šå½±å“äº¤å‰è§‚å¯Ÿå™¨çš„ç›‘æµ‹ï¼Œä¹Ÿå°±æ˜¯éƒ½ä¸ä¼šå½±å“Â `isIntersecting`Â å±æ€§çš„ç»“æœï¼Œä½†æ˜¯ä¼šå½±å“Â `isVisible`Â å±æ€§çš„ç»“æœï¼Œ å¦‚æœå…ƒç´ è®¾ç½®äº†Â `displayï¼šnone`Â å°±ä¸ä¼šè¢«æ£€æµ‹äº†ã€‚å½“ç„¶å½±å“å…ƒç´ å¯è§†æ€§çš„å±æ€§ä¸æ­¢ä¸Šè¿°è¿™äº›ï¼Œè¿˜åŒ…æ‹¬`position`ï¼Œ`margin`ï¼Œ`clip`Â ç­‰ç­‰ç­‰ç­‰... å°±é å°ä¼™ä¼´ä»¬è‡ªè¡Œå‘æ˜äº†

äº¤é›†çš„è®¡ç®—
-----

æ‰€æœ‰åŒºåŸŸå‡è¢«Â `Intersection Observer API`Â å½“åšä¸€ä¸ªÂ **çŸ©å½¢**Â çœ‹å¾…ã€‚å¦‚æœå…ƒç´ æ˜¯ä¸è§„åˆ™çš„å›¾å½¢ä¹Ÿå°†ä¼šè¢«çœ‹æˆä¸€ä¸ªåŒ…å«å…ƒç´ æ‰€æœ‰åŒºåŸŸçš„æœ€å°çŸ©å½¢ï¼Œç›¸ä¼¼çš„ï¼Œå¦‚æœå…ƒç´ å‘ç”Ÿçš„äº¤é›†éƒ¨åˆ†ä¸æ˜¯ä¸€ä¸ªçŸ©å½¢ï¼Œé‚£ä¹ˆä¹Ÿä¼šè¢«çœ‹ä½œæ˜¯ä¸€ä¸ªåŒ…å«ä»–æ‰€æœ‰äº¤é›†åŒºåŸŸçš„æœ€å°çŸ©å½¢ã€‚

æˆ‘æ€ä¹ˆçŸ¥é“ç›®æ ‡å…ƒç´ æ¥è‡ªè§†å£çš„ä¸Šæ–¹è¿˜æ˜¯ä¸‹æ–¹
--------------------

ç›®æ ‡å…ƒç´ æ»šåŠ¨çš„æ–¹å‘ä¹Ÿæ˜¯å¯ä»¥åˆ¤æ–­çš„ï¼ŒåŸç†æ˜¯æ ¹å…ƒç´ çš„Â `entry.rootBounds.y`Â æ˜¯å›ºå®šä¸å˜çš„ ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è®¡ç®—Â `entry.boundingClientRect.y`Â ä¸Â `entry.rootBounds.y`Â çš„å¤§å°ï¼Œå½“å›è°ƒå‡½æ•°è§¦å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®°å½•ä¸‹å½“æ—¶çš„ä½ç½®ï¼Œå¦‚æœÂ `entry.boundingClientRect.y < entry.rootBounds.y`ï¼Œè¯´æ˜æ˜¯åœ¨è§†å£ä¸‹æ–¹ï¼Œé‚£ä¹ˆå½“ä¸‹ä¸€æ¬¡ç›®æ ‡å…ƒç´ å¯è§çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±çŸ¥é“ç›®æ ‡å…ƒç´ æ—¶æ¥è‡ªè§†å£ä¸‹æ–¹çš„ï¼Œåä¹‹äº¦ç„¶ã€‚

```
letÂ wasAboveÂ =Â false;functionÂ callback(entries,Â observer)Â {Â Â Â Â entries.forEach(entryÂ =>Â {Â Â Â Â Â Â Â Â constÂ isAboveÂ =Â entry.boundingClientRect.yÂ <Â entry.rootBounds.y;Â Â Â Â Â Â Â Â ifÂ (entry.isIntersecting)Â {Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (wasAbove)Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ComesÂ fromÂ topÂ Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â wasAboveÂ =Â isAbove;Â Â Â Â });}
```

åº”ç”¨åœºæ™¯
====

ä»‹ç»å®ŒåŸºç¡€çŸ¥è¯†ï¼Œæ€»å¾—æ¥å‡ ä¸ªå®ä¾‹ (**æ¼”ç¤ºä»£ç é‡‡ç”¨ VUE3.0**)ï¼Œå½“ç„¶å®é™…åœºæ™¯è¦æ¯”è¿™å¤æ‚çš„å¤šï¼Œå¦‚ä½•åœ¨è‡ªå·±çš„å·¥ä½œå­¦ä¹ ä¸­åº”ç”¨ï¼Œè¿˜æ˜¯è¦é å°ä¼™ä¼´ä»¬å¤šå¤šå¼€åŠ¨èªæ˜çš„å¤§è„‘~

æ•°æ®åˆ—è¡¨æ— é™æ»šåŠ¨
--------

```
<template>Â Â <divÂ class="box">Â Â Â Â <divÂ class="vbody"Â Â Â Â Â Â Â Â Â v-for='itemÂ inÂ list'Â Â Â Â Â Â Â Â Â :key='item'>å†…å®¹åŒºåŸŸ{{item}}</div>Â Â Â Â <divÂ class="reference"Â Â Â Â Â Â Â Â Â ref='reference'></div>Â Â </div></template><scriptÂ lang='ts'>importÂ {Â defineComponent,Â onMounted,Â reactive,Â refÂ }Â fromÂ 'vue'exportÂ defaultÂ defineComponent({Â Â name:Â '',Â Â setup()Â {Â Â Â Â constÂ referenceÂ =Â ref(null)Â Â Â Â constÂ listÂ =Â reactive([1,Â 2,Â 3,Â 4,Â 5,Â 6,Â 7,Â 8,Â 9,Â 10])Â Â Â Â onMounted(()Â =>Â {Â Â Â Â Â Â letÂ nÂ =Â 10Â Â Â Â Â Â //å›è°ƒå‡½æ•°Â Â Â Â Â Â constÂ callbackÂ =Â (entries)Â =>Â {Â Â Â Â Â Â Â Â constÂ myEntryÂ =Â entries[0]Â Â Â Â Â Â Â Â ifÂ (myEntry.isIntersecting)Â {Â Â Â Â Â Â Â Â Â Â console.log(`ğŸš€ğŸš€~Â è§¦å‘äº†æ— çº¿æ»šåŠ¨,å¼€å§‹æ¨¡æ‹Ÿè¯·æ±‚æ•°æ®Â ${n}`)Â Â Â Â Â Â Â Â Â Â n++Â Â Â Â Â Â Â Â Â Â list.push(n)Â Â Â Â Â Â Â Â }Â Â Â Â Â Â }Â Â Â Â Â Â //é…ç½®å¯¹è±¡Â Â Â Â Â Â constÂ optionsÂ =Â {Â Â Â Â Â Â Â Â root:Â null,Â Â Â Â Â Â Â Â rootMargin:Â '0pxÂ 0pxÂ 0pxÂ 0px',Â Â Â Â Â Â Â Â threshold:Â [0,Â 1],Â Â Â Â Â Â Â Â trackVisibility:Â true,Â Â Â Â Â Â Â Â delay:Â 100,Â Â Â Â Â Â }Â Â Â Â Â Â //è§‚å¯Ÿå™¨å®ä¾‹Â Â Â Â Â Â constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options)Â Â Â Â Â Â //å¼€å§‹è§‚å¯ŸÂ Â Â Â Â Â myObserver.observe(reference.value)Â Â Â Â })Â Â Â Â returnÂ {Â reference,Â listÂ }Â Â },})</script><style>*Â {Â Â margin:Â 0;Â Â padding:Â 0;Â Â box-sizing:Â border-box;}.referenceÂ {Â Â width:Â 100%;Â Â visibility:Â hidden;}.vbodyÂ {Â Â width:Â 100%;Â Â height:Â 200px;Â Â background-color:Â red;Â Â color:Â aliceblue;Â Â font-size:Â 40px;Â Â text-align:Â center;Â Â line-height:Â 200px;Â Â margin:Â 10pxÂ 0;}</style>
```

æˆ‘ä»¬åªéœ€è¦åœ¨åº•éƒ¨æ·»åŠ ä¸€ä¸ªå‚è€ƒå…ƒç´ ï¼Œå½“å‚è€ƒå…ƒç´ å¯è§æ—¶ï¼Œå°±å‘åå°è¯·æ±‚æ•°æ®ï¼Œå°±å¯ä»¥å®ç°æ— çº¿æ»šåŠ¨çš„æ•ˆæœäº†ã€‚![](https://mmbiz.qpic.cn/mmbiz_gif/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79QgahOU6o1pCGUfciaMADOy27DibsH7vemCNwezHmDI93CbcNK8GvcMuQ/640?wx_fmt=gif)

å›¾ç‰‡é¢„åŠ è½½
-----

```
<template>Â Â <divÂ class="box">Â Â Â Â <divÂ class="vbody">å†…å®¹åŒºåŸŸ</div>Â Â Â Â <divÂ class="vbody">å†…å®¹åŒºåŸŸ</div>Â Â Â Â <divÂ class="header"Â Â Â Â Â Â Â Â Â ref='header'>Â Â Â Â Â Â <imgÂ :src="url">Â Â Â Â </div>Â Â Â Â <divÂ class="vbody">å†…å®¹åŒºåŸŸ</div>Â Â </div></template><scriptÂ lang='ts'>importÂ {Â defineComponent,Â onMounted,Â refÂ }Â fromÂ 'vue'exportÂ defaultÂ defineComponent({Â Â name:Â '',Â Â setup()Â {Â Â Â Â constÂ headerÂ =Â ref(null)Â Â Â Â constÂ urlÂ =Â ref('')Â Â Â Â onMounted(()Â =>Â {Â Â Â Â Â Â //å›è°ƒå‡½æ•°Â Â Â Â Â Â constÂ callbackÂ =Â (entries)Â =>Â {Â Â Â Â Â Â Â Â constÂ myEntryÂ =Â entries[0]Â Â Â Â Â Â Â Â ifÂ (myEntry.isIntersecting)Â {Â Â Â Â Â Â Â Â Â Â console.log('ğŸš€ğŸš€~Â é¢„åŠ è½½å›¾ç‰‡å¼€å§‹')Â Â Â Â Â Â Â Â Â Â url.valueÂ =Â Â Â Â Â Â Â Â Â Â Â Â '//img10.360buyimg.com/imgzone/jfs/t1/197235/15/2956/67824/6115e076Ede17a418/d1350d4d5e52ef50.jpg'Â Â Â Â Â Â Â Â }Â Â Â Â Â Â }Â Â Â Â Â Â //é…ç½®å¯¹è±¡Â Â Â Â Â Â constÂ optionsÂ =Â {Â Â Â Â Â Â Â Â root:Â null,Â Â Â Â Â Â Â Â rootMargin:Â '200pxÂ 200pxÂ 200pxÂ 200px',Â Â Â Â Â Â Â Â threshold:Â [0],Â Â Â Â Â Â Â Â trackVisibility:Â true,Â Â Â Â Â Â Â Â delay:Â 100,Â Â Â Â Â Â }Â Â Â Â Â Â //è§‚å¯Ÿå™¨å®ä¾‹Â Â Â Â Â Â constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options)Â Â Â Â Â Â //å¼€å§‹è§‚å¯ŸÂ Â Â Â Â Â myObserver.observe(header.value)Â Â Â Â })Â Â Â Â returnÂ {Â header,Â urlÂ }Â Â },})</script><style>*Â {Â Â margin:Â 0;Â Â padding:Â 0;Â Â box-sizing:Â border-box;}.boxÂ {}.headerÂ {Â Â width:Â 100%;Â Â height:Â 400px;Â Â background-color:Â blue;Â Â color:Â aliceblue;Â Â font-size:Â 40px;Â Â text-align:Â center;Â Â line-height:Â 400px;}.headerÂ imgÂ {Â Â width:Â 100%;Â Â height:Â 100%;}.referenceÂ {Â Â width:Â 100%;Â Â visibility:Â hidden;}.vbodyÂ {Â Â width:Â 100%;Â Â height:Â 800px;Â Â background-color:Â red;Â Â color:Â aliceblue;Â Â font-size:Â 40px;Â Â text-align:Â center;Â Â line-height:Â 800px;Â Â margin:Â 10pxÂ 0;}</style>
```

åˆ©ç”¨Â `options`Â çš„Â `rootMargin`å±æ€§ï¼Œå¯ä»¥åœ¨å›¾ç‰‡å³å°†è¿›å…¥å¯è§†åŒºåŸŸçš„æ—¶é—´è¿›è¡Œå›¾ç‰‡çš„åŠ è½½ï¼Œå³é¿å…äº†æå‰è¯·æ±‚å¤§é‡å›¾ç‰‡é€ æˆçš„æ€§èƒ½é—®é¢˜ï¼Œä¹Ÿé¿å…äº†å›¾ç‰‡è¿›å…¥çª—å£æ‰åŠ è½½å·²ç»æ¥ä¸åŠçš„é—®é¢˜ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79bN40OOficMiaLk75NJrKm6J54ibbA69e4g8I9SPtsbffK1Hickib4BPY7WQ/640?wx_fmt=jpeg)

å¸é¡¶
--

```
<template>Â Â <divÂ class="box">Â Â Â Â <divÂ class="reference"Â Â Â Â Â Â Â Â Â ref='reference'></div>Â Â Â Â <divÂ class="header"Â Â Â Â Â Â Â Â Â ref='header'>å¸é¡¶åŒºåŸŸ</div>Â Â Â Â <divÂ class="vbody">å†…å®¹åŒºåŸŸ</div>Â Â Â Â <divÂ class="vbody">å†…å®¹åŒºåŸŸ</div>Â Â Â Â <divÂ class="vbody">å†…å®¹åŒºåŸŸ</div>Â Â </div></template><scriptÂ lang='ts'>importÂ {Â defineComponent,Â onMounted,Â refÂ }Â fromÂ 'vue'exportÂ defaultÂ defineComponent({Â Â name:Â '',Â Â setup()Â {Â Â Â Â constÂ headerÂ =Â ref(null)Â Â Â Â constÂ referenceÂ =Â ref(null)Â Â Â Â onMounted(()Â =>Â {Â Â Â Â Â Â //å›è°ƒå‡½æ•°Â Â Â Â Â Â constÂ callbackÂ =Â (entries)Â =>Â {Â Â Â Â Â Â Â Â constÂ myEntryÂ =Â entries[0]Â Â Â Â Â Â Â Â ifÂ (!myEntry.isIntersecting)Â {Â Â Â Â Â Â Â Â Â Â console.log('ğŸš€ğŸš€~Â è§¦å‘äº†å¸é¡¶')Â Â Â Â Â Â Â Â Â Â header.value.style.positionÂ =Â 'fixed'Â Â Â Â Â Â Â Â Â Â header.value.style.topÂ =Â '0px'Â Â Â Â Â Â Â Â }Â elseÂ {Â Â Â Â Â Â Â Â Â Â console.log('ğŸš€ğŸš€~Â å–æ¶ˆå¸é¡¶')Â Â Â Â Â Â Â Â Â Â header.value.style.positionÂ =Â 'relative'Â Â Â Â Â Â Â Â }Â Â Â Â Â Â }Â Â Â Â Â Â //é…ç½®å¯¹è±¡Â Â Â Â Â Â constÂ optionsÂ =Â {Â Â Â Â Â Â Â Â root:Â null,Â Â Â Â Â Â Â Â rootMargin:Â '0pxÂ 0pxÂ 0pxÂ 0px',Â Â Â Â Â Â Â Â threshold:Â [0,Â 1],Â Â Â Â Â Â Â Â trackVisibility:Â true,Â Â Â Â Â Â Â Â delay:Â 100,Â Â Â Â Â Â }Â Â Â Â Â Â //è§‚å¯Ÿå™¨å®ä¾‹Â Â Â Â Â Â constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options)Â Â Â Â Â Â //å¼€å§‹è§‚å¯ŸÂ Â Â Â Â Â myObserver.observe(reference.value)Â Â Â Â })Â Â Â Â returnÂ {Â reference,Â headerÂ }Â Â },})</script><style>*Â {Â Â margin:Â 0;Â Â padding:Â 0;Â Â box-sizing:Â border-box;}.headerÂ {Â Â width:Â 100%;Â Â height:Â 100px;Â Â background-color:Â blue;Â Â color:Â aliceblue;Â Â font-size:Â 40px;Â Â text-align:Â center;Â Â line-height:Â 100px;}.referenceÂ {Â Â width:Â 100%;Â Â visibility:Â hidden;}.vbodyÂ {Â Â width:Â 100%;Â Â height:Â 800px;Â Â background-color:Â red;Â Â color:Â aliceblue;Â Â font-size:Â 40px;Â Â text-align:Â center;Â Â line-height:Â 800px;Â Â margin:Â 10pxÂ 0;}</style>
```

æ€è·¯å°±æ˜¯åˆ©ç”¨ä¸€ä¸ªå‚è€ƒå…ƒç´ ä½œä¸ºäº¤å‰è§‚å¯Ÿå™¨è§‚å¯Ÿçš„å¯¹è±¡ï¼Œå½“å‚è€ƒå…ƒç´ å¯è§çš„æ—¶å€™ï¼Œå–æ¶ˆå¸é¡¶åŒºåŸŸçš„Â `fixed`Â å±æ€§ï¼Œå¦åˆ™æ·»åŠ Â `fixed`Â å±æ€§ï¼Œå¸åº•ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œä½†æ˜¯é“ç†å·®ä¸å¤šï¼Œç•™ç»™å°ä¼™ä¼´ä»¬è‡ªè¡Œç ”ç©¶å§ ~ ~ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79k6qffTqSHricaGicEexCWwMaFh8buRcomXlg3vGbic04VnlWOowUlpT7w/640?wx_fmt=jpeg)

åŸ‹ç‚¹ä¸ŠæŠ¥
----

```
<template>Â Â <divÂ class="box">Â Â Â Â <divÂ class="vbody">å†…å®¹åŒºåŸŸ</div>Â Â Â Â <divÂ class="vbody">å†…å®¹åŒºåŸŸ</div>Â Â Â Â <divÂ class="header"Â Â Â Â Â Â Â Â Â ref='header'>åŸ‹ç‚¹åŒºåŸŸ</div>Â Â Â Â <divÂ class="vbody">å†…å®¹åŒºåŸŸ</div>Â Â </div></template><scriptÂ lang='ts'>importÂ {Â defineComponent,Â onMounted,Â refÂ }Â fromÂ 'vue'exportÂ defaultÂ defineComponent({Â Â name:Â '',Â Â setup()Â {Â Â Â Â constÂ headerÂ =Â ref(null)Â Â Â Â onMounted(()Â =>Â {Â Â Â Â Â Â //å›è°ƒå‡½æ•°Â Â Â Â Â Â constÂ callbackÂ =Â (entries)Â =>Â {Â Â Â Â Â Â Â Â constÂ myEntryÂ =Â entries[0]Â Â Â Â Â Â Â Â ifÂ (myEntry.isIntersecting)Â {Â Â Â Â Â Â Â Â Â Â console.log('ğŸš€ğŸš€~Â è§¦å‘äº†åŸ‹ç‚¹')Â Â Â Â Â Â Â Â }Â Â Â Â Â Â }Â Â Â Â Â Â //é…ç½®å¯¹è±¡Â Â Â Â Â Â constÂ optionsÂ =Â {Â Â Â Â Â Â Â Â root:Â null,Â Â Â Â Â Â Â Â rootMargin:Â '0pxÂ 0pxÂ 0pxÂ 0px',Â Â Â Â Â Â Â Â threshold:Â [0.5],Â Â Â Â Â Â Â Â trackVisibility:Â true,Â Â Â Â Â Â Â Â delay:Â 100,Â Â Â Â Â Â }Â Â Â Â Â Â //è§‚å¯Ÿå™¨å®ä¾‹Â Â Â Â Â Â constÂ myObserverÂ =Â newÂ IntersectionObserver(callback,Â options)Â Â Â Â Â Â //å¼€å§‹è§‚å¯ŸÂ Â Â Â Â Â myObserver.observe(header.value)Â Â Â Â })Â Â Â Â returnÂ {Â headerÂ }Â Â },})</script><style>*Â {Â Â margin:Â 0;Â Â padding:Â 0;Â Â box-sizing:Â border-box;}.headerÂ {Â Â width:Â 100%;Â Â height:Â 400px;Â Â background-color:Â blue;Â Â color:Â aliceblue;Â Â font-size:Â 40px;Â Â text-align:Â center;Â Â line-height:Â 400px;}.vbodyÂ {Â Â width:Â 100%;Â Â height:Â 800px;Â Â background-color:Â red;Â Â color:Â aliceblue;Â Â font-size:Â 40px;Â Â text-align:Â center;Â Â line-height:Â 800px;Â Â margin:Â 10pxÂ 0;}</style>
```

é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç»Ÿè®¡ä¸€ä¸ªå…ƒç´ æ˜¯å¦è¢«ç”¨æˆ·æœ‰æ•ˆçš„çœ‹åˆ°ï¼Œå¹¶ä¸æ˜¯å…ƒç´ åˆšå‡ºç°å°±è§¦å‘åŸ‹ç‚¹ï¼Œè€Œæ˜¯å…ƒç´ è¿›å…¥å¯æ˜¯åŒºåŸŸä¸€å®šæ¯”ä¾‹æ‰å¯ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®Â `options`Â çš„Â `threshold`Â ä¸ºÂ `0.5`ã€‚![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc795BWhj9jbAdCLVGcWwft9Wl9q6XiaTiaibDibDBRmQgQE4O7sHjEtVRBYeg/640?wx_fmt=jpeg)

ç­‰ç­‰ç­‰ç­‰ã€‚ã€‚ã€‚ã€‚

è¿™ä¸ªÂ `api`Â å¯ä»¥è¯´æ˜¯éå¸¸å¼ºå¤§äº†ï¼Œå¯ç©æ€§ä¹Ÿæ˜¯æé«˜ï¼Œå¤§å®¶è‡ªç”±å‘æŒ¥ ~ ~

å…¼å®¹æ€§
===

![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc791vaNqF3h4SboCvCMhBPC4yfBuV3PuUegh8DwgqxMibiaedaNYqCJmBTg/640?wx_fmt=jpeg)![](https://mmbiz.qpic.cn/mmbiz/lP9iauFI73zibBiao6tMT2mzaia9LmpEuc79JAv6IZc3Z9ydibDlw8odQTIOZyX93Ssblg8vNBNBVYWjjbWgc7GqxPQ/640?wx_fmt=jpeg)ä¸ºä»€ä¹ˆæœ‰ä¸¤å¼ å…¼å®¹æ€§çš„å›¾å‘¢ï¼Ÿå› ä¸ºÂ **trackVisibility**Â å’ŒÂ **delay**Â ä¸¤ä¸ªå±æ€§æ˜¯å±äºÂ `IntersectionObserver V2`Â çš„ã€‚æ‰€ä»¥å°ä¼™ä¼´ä»¬åœ¨ç”¨çš„æ—¶å€™ä¸€å®šè¦æ³¨æ„å…¼å®¹æ€§ã€‚å½“ç„¶ä¹Ÿæœ‰å…¼å®¹è§£å†³æ–¹æ¡ˆï¼Œé‚£å°±æ˜¯Â `intersection-observer-polyfill`

å‚è€ƒèµ„æ–™
----

**[1] Can I Use:**

https://caniuse.com/?search=IntersectionObserver%20

**[2] MDN Intersection Observer:**

https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver

**[3] IntersectionObserver API ä½¿ç”¨æ•™ç¨‹:**

https://www.ruanyifeng.com/blog/2016/11/intersectionobserver_api.html

**[4] intersection-observer-polyfill:**

https://www.npmjs.com/package/intersection-observer-polyfill