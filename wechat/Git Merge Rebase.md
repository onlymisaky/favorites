> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/WhxMfkBpsoFCI6kNIJTwiA)

在使用 Git 进行版本控制时，理解何时使用 `git merge` 和 `git rebase` 对于高效和有序的代码管理至关重要。虽然两者都是用于合并代码的强大工具，但它们在不同情境下的适用性和影响各不相同。本文旨在深入探讨这两种命令，并指导何时以及如何正确使用它们。

Git Merge
---------

### 概述

`git merge` 是一种非破坏性操作，用于将两个分支的更改合并到一起。它通过创建一个新的 “合并提交”（G'），将两个分支的历史联系起来。

### 优点

*   **保留历史完整性**：合并操作保持了两个分支的原始历史不变。
    
*   **简单直观**：对于 Git 新手来说， `merge` 更易于理解和操作。
    

### 使用场景

`git merge` 特别适用于团队协作环境，其中保留完整的历史记录和明确的合并点是有价值的。

Git Rebase
----------

### 概述

`git rebase` 重新定位分支上的更改，将它们放在另一分支的最新更改之上。这通常涉及重写提交历史，使其看起来更加线性。

### 优点

*   **清晰的线性历史**： `rebase` 为项目提供了一个干净、直线的历史。
    
*   **避免冗余合并提交**：有助于减少不必要的合并提交。
    

### 使用场景

`rebase` 是理想的选择，当你想要整理个人分支上的提交，或者在团队中共享更改之前更新你的特性分支。

Git 变基的黄金规则
-----------

"永远不要在公共分支上使用 git rebase"。这是因为变基会改变历史，可能导致团队成员间的历史不一致，从而引起混乱。

选择 Git Merge 还是 Git Rebase？
---------------------------

在决定使用 `git merge` 还是 `git rebase` 时，重要的是要考虑你的工作环境和团队的工作流程：

*   在私人或尚未公开的特性分支上，尤其是在准备进行拉取请求（Pull Request）之前， `git rebase` 可以帮助保持历史清晰。
    
*   在团队协作的公共分支上， `git merge` 是更安全的选择，因为它保留了完整的历史记录，易于团队成员理解和追踪。
    

在 Push 代码时遇见冲突时用 Git Merge 还是 Git Rebase?
-----------------------------------------

当在执行 `git push` 时遇到冲突，通常是因为远程仓库中的分支比你的本地分支更进一步。这种情况下，你可以选择使用 `git merge` 或 `git rebase` 来解决冲突，但每种方法的影响略有不同。

### 使用 Git Merge

如果选择使用 `git merge` 来解决 `git push` 时的冲突，你可以先将远程分支的更改合并到你的本地分支。

1. **操作步骤**：

*   先拉取远程分支的更新： `git pull` 或 `git fetch` 后跟 `git merge`。
    
*   解决可能出现的任何合并冲突。
    
*   完成合并后再次尝试 `git push`。
    

2. **影响**：

*   这会在你的历史中创建一个新的合并提交，显示你合并了远程更改。
    
*   它保留了两个分支的完整历史，包括你的本地更改和远程的更改。
    

### 使用 Git Rebase

使用 `git rebase` 解决 `git push` 时的冲突涉及将你的更改重新应用在远程分支的最新提交之上。

1. **操作步骤**：

*   先拉取远程分支的更新： `git fetch`。
    
*   然后使用 `git rebase` 将你的本地分支上的更改放在远程分支的最新更改之上。
    
*   解决在变基过程中出现的任何冲突。
    
*   完成变基后，再次尝试 `git push`，可能需要使用 `git push--force`，如果你已经将更改推送到了公共分支上。
    

2. **影响**：

*   这会创建一个线性的历史记录，看起来就像你的更改是在远程的最新更改之后完成的。
    
*   它可以简化项目的历史，但可能会改变你的提交历史。
    

### 选择哪一种？

选择 `git merge` 还是 `git rebase` 取决于你想要的项目历史记录的类型，以及你的工作流程。

*   如果你想保持项目历史的完整性并且希望清楚地显示所有更改的来源，那么 `git merge` 是更好的选择。
    
*   如果你倾向于保持一个清洁、线性的历史记录，并且你的团队对使用 `git rebase` 和解决可能出现的冲突感到舒适，那么可以选择 `git rebase`。
    

在团队环境中，最重要的是确保所有团队成员都理解并遵守相同的工作流程，无论是选择 `merge` 还是 `rebase`。

结论
--

理解 `git merge` 和 `git rebase` 的区别及其各自的优势，可以帮助你更好地管理代码和协作。在任何情况下，谨慎地处理冲突并确保团队成员对合并策略有共识，是保持项目健康的关键。
