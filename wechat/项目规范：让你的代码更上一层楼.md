> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Za3FE5cpDpy5ygfrVL9TOQ)

#### åˆå§‹åŒ–é¡¹ç›®

*   vscode é‡Œä¸‹å¥½æ’ä»¶ï¼šeslintï¼Œprettierï¼Œstylelint
    
*   å®˜ç½‘æ¨¡ç‰ˆåˆ›å»ºé¡¹ç›®ï¼š`pnpm create vite react-starter \--template react-swc-ts`
    
*   å®‰è£…ä¾èµ–ï¼š`pnpm i`
    
*   åé¢æœ‰å¯èƒ½é‡åˆ° ts ç±»å‹é”™è¯¯ï¼Œå¯ä»¥æå‰å®‰è£…ä¸€ä¸ª`pnpm i @types/node \-D`
    

#### é…ç½® npm ä½¿ç”¨æ·˜å®é•œåƒ

*   é…ç½®`npmrc`
    

`registry = "https://registry.npmmirror.com/"`

#### é…ç½® node ç‰ˆæœ¬é™åˆ¶æç¤º

*   package.json ä¸­é…ç½®
    

`"engines": { "node": ">=16.0.0" },`

#### é…ç½® eslint æ£€æŸ¥ä»£ç è§„èŒƒ

> eslint å¤„ç†ä»£ç è§„èŒƒ, prettier å¤„ç†ä»£ç é£æ ¼ eslint é€‰æ‹©åªæ£€æŸ¥é”™è¯¯ä¸å¤„ç†é£æ ¼ï¼Œè¿™æ · eslint å°±ä¸ä¼šå’Œ prettier å†²çª react å®˜ç½‘æœ‰æä¾›ä¸€ä¸ª hook çš„ eslint (eslint-plugin-react-hooks)ï¼Œç”¨å¤„ä¸å¤§å°±ä¸ä½¿ç”¨äº†

*   å®‰è£…ï¼š`pnpm i eslint \-D`
    
*   ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼š`eslint \--init`ï¼ˆå¦‚æœæ²¡ eslint, å¯ä»¥å…¨å±€å®‰è£…ä¸€ä¸ªï¼Œç„¶åä½¿ç”¨ npx eslint --initï¼‰
    

```
-Â ToÂ checkÂ syntaxÂ andÂ findÂ problemsÂ Â //è¿™ä¸ªé€‰é¡¹æ˜¯eslinté»˜è®¤é€‰é¡¹ï¼Œè¿™æ ·å°±ä¸ä¼šå’Œpretterèµ·é£æ ¼å†²çª-Â JavaScriptÂ modulesÂ (import/export)-Â React-Â YES-Â Browser-Â JSON-Â Yes-Â pnpm
```

*   é…ç½®`eslintrc.json->rules`é‡Œé…ç½®ä¸ç”¨æ‰‹åŠ¨å¼•å…¥ reactï¼Œå’Œé…ç½®ä¸å¯ä»¥ä½¿ç”¨ any
    
*   æ³¨æ„ä½¿ç”¨ React.FC çš„æ—¶å€™å¦‚æœæŠ¥é”™è¯´æ²¡æœ‰å®šä¹‰ props ç±»å‹ï¼Œé‚£éœ€è¦å¼•å…¥ä¸€ä¸‹ react
    

```
"rules":Â {Â //ä¸ç”¨æ‰‹åŠ¨å¼•å…¥reactÂ "react/react-in-jsx-scope":Â "off",Â //ä½¿ç”¨anyæŠ¥é”™Â "@typescript-eslint/no-explicit-any":Â "error",}
```

*   å·¥ä½œåŒºé…ç½®`.vscode>settings.json`ï¼Œé…ç½®å vscode ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç é£æ ¼
    

æ¯”å¦‚å†™äº†ä¸€ä¸ª var a = 100, ä¼šè¢«è‡ªåŠ¨æ ¼å¼åŒ–ä¸º const a = 100

```
{Â "editor.codeActionsOnSave":Â {Â //Â æ¯æ¬¡ä¿å­˜çš„æ—¶å€™å°†ä»£ç æŒ‰ç…§Â eslintÂ æ ¼å¼è¿›è¡Œä¿®å¤Â "source.fixAll.eslint":Â true,Â //è‡ªåŠ¨æ ¼å¼åŒ–Â "editor.formatOnSave":Â trueÂ }}
```

*   é…ç½®`.eslintignore`ï¼Œeslint ä¼šè‡ªåŠ¨è¿‡æ»¤ node_modules
    

`dist`

*   æŒæ¡`eslintæ ¼å¼åŒ–å‘½ä»¤`ï¼Œåé¢ä½¿ç”¨ lint-staged æäº¤ä»£ç çš„æ—¶å€™éœ€è¦é…ç½®
    
    ä¸ºä»€ä¹ˆä¸Šé¢æœ‰ vscode è‡ªåŠ¨ eslint æ ¼å¼åŒ–ï¼Œè¿˜éœ€è¦å‘½ä»¤è¡Œ: å› ä¸ºå‘½ä»¤è¡Œèƒ½ä¸€æ¬¡æ€§çˆ†å‡ºæ‰€æœ‰è­¦å‘Šé—®é¢˜ï¼Œä¾¿äºæ‰¾åˆ°ä½ç½®ä¿®å¤
    

```
npxÂ eslintÂ .Â --fix//ç”¨npxä½¿ç”¨é¡¹ç›®é‡Œçš„eslint,æ²¡æœ‰çš„è¯ä¹Ÿä¼šå»ä½¿ç”¨å…¨å±€çš„eslinteslintÂ .Â --fixÂ //å…¨éƒ¨ç±»å‹æ–‡ä»¶eslintÂ .Â --extÂ .ts,.tsxÂ --fixÂ //--extå¯ä»¥æŒ‡å®šæ–‡ä»¶åç¼€ås
```

eslintrc.json é‡Œé…ç½®

```
"env":Â {Â "browser":Â true,Â "es2021":Â true,Â "node":Â trueÂ //Â å› ä¸ºæ¯”å¦‚é…ç½®viteçš„æ—¶å€™ä¼šä½¿ç”¨åˆ°},
```

#### é…ç½® prettier æ£€æŸ¥ä»£ç é£æ ¼

> prettier æ ¼å¼åŒ–é£æ ¼ï¼Œå› ä¸ºä½¿ç”¨ tailwindï¼Œä½¿ç”¨ tailwind å®˜æ–¹æ’ä»¶

*   å®‰è£…ï¼š`pnpm i prettier prettier-plugin-tailwindcss \-D`
    
*   é…ç½®`.prettierrc.json`
    

æ³¨é‡Šè¦åˆ æ‰ï¼Œprettier çš„é…ç½®æ–‡ä»¶ json ä¸æ”¯æŒæ³¨é‡Š

```
{Â "singleQuote":Â true,Â //Â å•å¼•å·Â "semi":Â false,Â //Â åˆ†å·Â "trailingComma":Â "none",Â //Â å°¾éšé€—å·Â "tabWidth":Â 2,Â //Â ä¸¤ä¸ªç©ºæ ¼ç¼©è¿›Â "plugins":Â ["prettier-plugin-tailwindcss"]Â //tailwindæ’ä»¶}
```

*   é…ç½®`.prettierignore`
    

```
dist
pnpm-lock.yaml
```

*   é…ç½®`.vscode>settings.json`ï¼Œé…ç½®å vscode ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç é£æ ¼
    

```
{Â "editor.codeActionsOnSave":Â {Â Â Â //Â æ¯æ¬¡ä¿å­˜çš„æ—¶å€™å°†ä»£ç æŒ‰ç…§Â eslintÂ æ ¼å¼è¿›è¡Œä¿®å¤Â Â Â "source.fixAll.eslint":Â trueÂ },Â //è‡ªåŠ¨æ ¼å¼åŒ–Â "editor.formatOnSave":Â true,Â //é£æ ¼ç”¨prettierÂ "editor.defaultFormatter":Â "esbenp.prettier-vscode"}
```

*   æŒæ¡`prettierå‘½ä»¤è¡Œ`
    

å¯ä»¥è®©ä¹‹å‰æ²¡æœ‰æ ¼å¼åŒ–çš„é”™è¯¯ä¸€æ¬¡æ€§æš´éœ²å‡ºæ¥

`npx prettier --write .//ä½¿ç”¨Prettieræ ¼å¼åŒ–æ‰€æœ‰æ–‡ä»¶`

#### é…ç½® husky ä½¿ç”¨ git hook

> è®°å¾—è¦åˆå§‹åŒ–ä¸€ä¸ª git ä»“åº“ï¼Œhusky èƒ½æ‰§è¡Œ git hookï¼Œåœ¨ commit çš„æ—¶å€™å¯¹æ–‡ä»¶è¿›è¡Œæ“ä½œ

*   å®‰è£…
    

`sudo pnpm dlx husky-init`

`pnpm install`

`npx husky add .husky/commit-msg 'npx \--no \-- commitlint \--edit "$1"'`ï¼Œcommit-msg ä½¿ç”¨ commitlint

`npx husky add .husky/pre-commit "npm run lint-staged"`ï¼Œpre-commit ä½¿ç”¨ lint-staged

#### é…ç½® commitlint æ£€æŸ¥æäº¤ä¿¡æ¯

> æäº¤è§„èŒƒå‚è€ƒï¼šwww.conventionalcommits.org/en/v1.0.0/[1]

*   å®‰è£…`pnpm i @commitlint/cli @commitlint/config-conventional \-D`
    
*   é…ç½®`.commitlintrc.json`
    

`{ extends: ['@commitlint/config-conventional'] }`

#### é…ç½® lint-staged å¢é‡å¼æ£€æŸ¥

*   å®‰è£…`pnpm i \-D lint-staged`
    
*   é…ç½®`package.json`
    

```
"scripts":Â {Â "dev":Â "vite",Â "build":Â "tscÂ &&Â viteÂ build",Â "preview":Â "viteÂ preview",Â "prepare":Â "huskyÂ install",Â "lint-staged":Â "npxÂ lint-staged"//æ–°å¢ï¼Œå¯¹åº”ä¸Šé¢çš„huskyå‘½ä»¤},
```

*   é…ç½®`.lintstagedrc.json`
    

```
{Â "*.{ts,tsx,json}":Â ["prettierÂ --write",Â "eslintÂ --fix"],Â "*.css":Â ["stylelintÂ --fix",Â "prettierÂ --write"]}
```

#### é…ç½® viteï¼ˆä»£ç† / åˆ«å / drop console ç­‰ï¼‰

> å¦‚æœæœ‰å…¼å®¹æ€§è€ƒè™‘ï¼Œéœ€è¦ä½¿ç”¨ legacy æ’ä»¶ï¼Œvite ä¹Ÿæœ‰ vscode æ’ä»¶ï¼Œä¹Ÿå¯ä»¥ä¸‹è½½ä½¿ç”¨

*   ä¸€äº›æ–¹ä¾¿å¼€å‘çš„é…ç½®
    

```
importÂ {Â defineConfigÂ }Â fromÂ 'vite'importÂ reactÂ fromÂ '@vitejs/plugin-react-swc'importÂ pathÂ fromÂ 'path'//Â https://vitejs.dev/config/exportÂ defaultÂ defineConfig({Â esbuild:Â {Â Â Â drop:Â ['console',Â 'debugger']Â },Â css:Â {Â Â Â //Â å¼€cssÂ sourcemapæ–¹ä¾¿æ‰¾cssÂ Â Â devSourcemap:Â trueÂ },Â plugins:Â [react()],Â server:Â {Â Â Â //Â è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨Â Â Â open:Â trueï¼ŒÂ Â Â proxy:Â {Â Â Â Â Â '/api':Â {Â Â Â Â Â Â Â target:Â 'https://xxxxxx',Â Â Â Â Â Â Â changeOrigin:Â true,Â Â Â Â Â Â Â rewrite:Â (path)Â =>Â path.replace(/^\/api/,Â '')Â Â Â Â Â }Â Â Â }Â },Â resolve:Â {Â Â Â //Â é…ç½®åˆ«åÂ Â Â alias:Â {Â '@':Â path.resolve(__dirname,Â './src')Â }Â },Â //æ‰“åŒ…è·¯å¾„å˜ä¸ºç›¸å¯¹è·¯å¾„,ç”¨liveServeræ‰“å¼€,ä¾¿äºæœ¬åœ°æµ‹è¯•æ‰“åŒ…åçš„æ–‡ä»¶Â base:Â './'})
```

*   é…ç½®æ‰“åŒ…åˆ†æï¼Œç”¨ legacy å¤„ç†å…¼å®¹æ€§
    

`pnpm i rollup-plugin-visualizer \-D`

`pnpm i @vitejs/plugin-legacy \-D`ï¼Œå®é™…é‡åˆ°äº†å†çœ‹å®˜ç½‘ç”¨

```
importÂ {Â defineConfigÂ }Â fromÂ 'vite'importÂ reactÂ fromÂ '@vitejs/plugin-react-swc'importÂ {Â visualizerÂ }Â fromÂ 'rollup-plugin-visualizer'importÂ legacyÂ fromÂ '@vitejs/plugin-legacy'importÂ pathÂ fromÂ 'path'//Â https://vitejs.dev/config/exportÂ defaultÂ defineConfig({Â css:Â {Â Â Â //Â å¼€cssÂ sourcemapæ–¹ä¾¿æ‰¾cssÂ Â Â devSourcemap:Â trueÂ },Â plugins:Â [Â Â Â react(),Â Â Â visualizer({Â Â Â Â Â open:Â falseÂ //Â æ‰“åŒ…å®Œæˆåè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼Œæ˜¾ç¤ºäº§ç‰©ä½“ç§¯æŠ¥å‘ŠÂ Â Â }),Â Â Â //è€ƒè™‘å…¼å®¹æ€§ï¼Œå®é™…é‡åˆ°äº†å†çœ‹å®˜ç½‘ç”¨Â Â Â legacy({Â Â Â Â Â targets:Â ['ieÂ >=Â 11'],Â Â Â Â Â additionalLegacyPolyfills:Â ['regenerator-runtime/runtime']Â Â Â })Â ],Â server:Â {Â Â Â //Â è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨Â Â Â open:Â trueÂ },Â resolve:Â {Â Â Â //Â é…ç½®åˆ«åÂ Â Â alias:Â {Â '@':Â path.resolve(__dirname,Â './src')Â }Â },Â //æ‰“åŒ…è·¯å¾„å˜ä¸ºç›¸å¯¹è·¯å¾„,ç”¨liveServeræ‰“å¼€,ä¾¿äºæœ¬åœ°æµ‹è¯•æ‰“åŒ…åçš„æ–‡ä»¶Â base:Â './'})
```

*   å¦‚æœæƒ³æ‰‹æœºä¸Šçœ‹ç½‘é¡µï¼Œå¯ä»¥`pnpm dev \--host`
    
*   å¦‚æœæƒ³åˆ é™¤ consoleï¼Œå¯ä»¥æŒ‰`h`å» help å¸®åŠ©ï¼Œå†æŒ‰`c`å°±å¯ä»¥ clear console
    

#### é…ç½® tsconfig

*   tsconfig.json éœ€è¦æ”¯æŒåˆ«å
    

```
{Â "compilerOptions":Â {Â Â Â "target":Â "ESNext",Â Â Â "useDefineForClassFields":Â true,Â Â Â "lib":Â ["DOM",Â "DOM.Iterable",Â "ESNext"],Â Â Â "allowJs":Â false,Â Â Â "skipLibCheck":Â true,Â Â Â "esModuleInterop":Â false,Â Â Â "allowSyntheticDefaultImports":Â true,Â Â Â "strict":Â true,Â Â Â "forceConsistentCasingInFileNames":Â true,Â Â Â "module":Â "ESNext",Â Â Â "moduleResolution":Â "Node",Â Â Â "resolveJsonModule":Â true,Â Â Â "isolatedModules":Â true,Â Â Â "noEmit":Â true,Â Â Â "jsx":Â "react-jsx",Â Â Â "baseUrl":Â "./",Â Â Â "paths":Â {Â Â Â Â Â "@/*":Â ["src/*"]Â Â Â }Â Â },Â Â "include":Â ["src"],Â Â "references":Â [{Â "path":Â "./tsconfig.node.json"Â }]}
```

#### é…ç½® router

*   å®‰è£…ï¼š`pnpm i react-router-dom`
    
*   é…ç½®`router->index.ts`
    

```
importÂ {Â lazyÂ }Â fromÂ 'react'importÂ {Â createBrowserRouterÂ }Â fromÂ 'react-router-dom'constÂ HomeÂ =Â lazy(()Â =>Â import('@/pages/home'))constÂ routerÂ =Â createBrowserRouter([Â {Â Â Â path:Â '/',Â Â Â element:Â <Home></Home>Â }])exportÂ defaultÂ router
```

*   é…ç½®`main.tsx`
    

```
import { RouterProvider } from 'react-router-dom'
import ReactDOM from 'react-dom/client'
import './global.css'
import router from './router'
ReactDOM.createRoot(document.getElementById('root') as HTMLElement).render(
 <RouterProvider router={router} />
)
```

#### é…ç½® zustand çŠ¶æ€ç®¡ç†

*   å®‰è£…`pnpm i zustand`
    
*   store->index.ts
    

```
importÂ {Â createÂ }Â fromÂ 'zustand'interfaceÂ appsStateÂ {Â nums:Â numberÂ setNumber:Â (nums:Â number)Â =>Â void}constÂ useAppsStoreÂ =Â create<appsState>((set)Â =>Â ({Â nums:Â 0,Â setNumber:Â (num)Â =>Â {Â Â Â returnÂ set(()Â =>Â ({Â Â Â Â Â nums:Â numÂ Â Â }))Â }}))exportÂ defaultÂ useAppsStore
```

*   ä½¿ç”¨æ–¹æ³•
    

```
importÂ ButtonÂ fromÂ '@/comps/custom-button'importÂ useAppsStoreÂ fromÂ '@/store/app'constÂ ZustandDemo:Â React.FCÂ =Â ()Â =>Â {Â constÂ {Â nums,Â setNumberÂ }Â =Â useAppsStore()Â constÂ handleNumÂ =Â ()Â =>Â {Â Â Â setNumber(numsÂ +Â 1)Â }Â returnÂ (Â Â Â <divÂ class>æ•°æ®/æ›´æ–°</h1>Â Â Â Â Â Â Â <ButtonÂ click={handleNum}>ç‚¹å‡»äº‹ä»¶</Button>Â Â Â Â Â <h1Â class>{nums}</h1>Â Â Â </div>Â )}exportÂ defaultÂ ZustandDemo
```

#### é…ç½® antd

*   æ–°ç‰ˆæœ¬çš„ antdï¼Œç›´æ¥ä¸‹è½½å°±å¯ä»¥ç”¨ï¼Œå¦‚æœç”¨åˆ°å®ƒçš„å›¾ç‰‡å†å•ç‹¬ä¸‹è½½`pnpm i antd`
    
*   æ³¨æ„ antd5 ç‰ˆæœ¬çš„ css å…¼å®¹æ€§ä¸å¥½ï¼Œå¦‚æœé¡¹ç›®æœ‰å…¼å®¹æ€§è¦æ±‚ï¼Œéœ€è¦å»å•ç‹¬é…ç½®
    

#### é…ç½® Tailwind css

`pnpm i tailwindcss autoprefixer postcss`

tailwind.config.cjs

```
//Â æ‰“åŒ…åä¼šæœ‰1kbçš„cssç”¨ä¸åˆ°çš„ï¼Œæ²¡æœ‰å½±å“//Â ç”¨äº†antdç»„ä»¶å…³ç³»ä¹Ÿä¸å¤§ï¼Œantd5çš„æ ·å¼æ˜¯æŒ‰éœ€çš„/**Â @typeÂ {import('tailwindcss').Config}Â */module.exportsÂ =Â {Â darkMode:Â 'class',Â content:Â ['./index.html',Â './src/**/*.{js,ts,jsx,tsx}'],Â theme:Â {Â extend:Â {Â //Â colors:Â {Â //Â Â Â themeColor:Â '#ff4132',Â //Â Â Â textColor:Â '#1a1a1a'Â //Â },Â //Â å¦‚æœå†™è‡ªé€‚åº”å¸ƒå±€ï¼Œå¯ä»¥æŒ‡å®šè®¾è®¡ç¨¿ä¸º1000px,ç„¶ååªéœ€è¦å†™/10çš„æ•°å€¼Â //Â fontSize:Â {Â //Â Â Â xs:Â '3.3vw',Â //Â Â Â sm:Â '3.9vw'Â //Â }Â }Â },Â plugins:Â []}
```

postcss.config.cjs

```
module.exportsÂ =Â {Â plugins:Â {Â tailwindcss:Â {},Â autoprefixer:Â {}Â }}
```

æˆ‘å–œæ¬¢æ–°å»ºä¸€ä¸ª apply.css å¼•å…¥åˆ°å…¨å±€

```
@tailwindÂ base;@tailwindÂ components;@tailwindÂ utilities;.margin-centerÂ {Â @applyÂ mx-autoÂ my-0;}.flex-centerÂ {Â @applyÂ flexÂ justify-centerÂ items-center;}.absolute-centerÂ {Â @applyÂ absoluteÂ top-1/2Â left-1/2Â -translate-x-1/2Â -translate-y-1/2;}
```

#### å°è£… fetch è¯·æ±‚

> è¿™ä¸ªå°è£…ä»…ä¾›å‚è€ƒï¼ŒTS ç±»å‹æœ‰ç‚¹å°é—®é¢˜

```
//Â å¯ä»¥ä¼ å…¥è¿™äº›é…ç½®interfaceÂ BaseOptionsÂ {Â method?:Â stringÂ credentials?:Â RequestCredentialsÂ headers?:Â HeadersInitÂ body?:Â stringÂ |Â null}//Â è¯·æ±‚æ–¹å¼typeÂ HttpMethodÂ =Â 'GET'Â |Â 'POST'Â |Â 'PUT'Â |Â 'PATCH'Â |Â 'DELETE'Â |Â 'HEAD'//Â ç¬¬ä¸€å±‚å‡ºå‚interfaceÂ ResponseObjectÂ {Â ok:Â booleanÂ error:Â booleanÂ status:Â numberÂ contentType:Â stringÂ |Â nullÂ bodyText:Â stringÂ response:Â Response}//Â è¯·æ±‚å¤´ç±»å‹typeÂ JSONHeaderÂ =Â {Â Accept:Â stringÂ 'Content-Type':Â string}//Â åˆ›å»ºç±»classÂ RequestÂ {Â privateÂ baseOptions:Â BaseOptionsÂ =Â {}Â //Â æ ¹æ®ä¼ å…¥çš„Â baseOptionsÂ åšä¸ºåˆå§‹åŒ–å‚æ•°Â constructor(options?:Â BaseOptions)Â {Â Â Â this.setBaseOptions(optionsÂ ||Â {})Â }Â publicÂ setBaseOptions(options:Â BaseOptions):Â BaseOptionsÂ {Â Â Â this.baseOptionsÂ =Â optionsÂ Â Â returnÂ this.baseOptionsÂ }Â //Â ä¹Ÿæä¾›è·å–Â baseOptionÂ çš„æ–¹æ³•Â publicÂ getBaseOptions():Â BaseOptionsÂ {Â Â Â returnÂ this.baseOptionsÂ }Â //Â æ ¸å¿ƒè¯·æ±‚Â TÂ ä¸ºå…¥å‚ç±»å‹ï¼ŒResponseObjectÂ ä¸ºå‡ºå‚ç±»å‹Â publicÂ request<T>(Â Â Â method:Â HttpMethod,Â Â Â url:Â string,Â Â Â data?:Â T,Â //æ”¯æŒä½¿ç”¨getçš„æ—¶å€™é…ç½®{key,value}çš„queryå‚æ•°Â Â Â options?:Â BaseOptionsÂ //è¿™é‡Œä¹Ÿæœ‰ä¸ªÂ baseÂ çš„Â methodÂ ):Â Promise<ResponseObject>Â {Â Â Â //Â é»˜è®¤Â baseOptionsÂ Â Â constÂ defaults:Â BaseOptionsÂ =Â {Â Â Â Â Â methodÂ Â Â Â Â //Â credentials:Â 'same-origin'Â Â Â }Â Â Â //Â æ”¶é›†æœ€åè¦ä¼ å…¥çš„é…ç½®Â Â Â constÂ settings:Â BaseOptionsÂ =Â Object.assign(Â Â Â {},Â Â Â defaults,Â Â Â this.baseOptions,Â Â Â optionsÂ )Â //Â å¦‚æœÂ methodÂ æ ¼å¼é”™è¯¯Â ifÂ (!settings.methodÂ ||Â typeofÂ settings.methodÂ !==Â 'string')Â throwÂ Error('[fetch-json]Â HTTPÂ methodÂ missingÂ orÂ invalid.')Â //Â å¦‚æœÂ urlÂ æ ¼å¼é”™è¯¯Â ifÂ (typeofÂ urlÂ !==Â 'string')Â throwÂ Error('[fetch-json]Â URLÂ mustÂ beÂ aÂ string.')Â //Â æ”¯æŒå¤§å°å†™Â constÂ httpMethodÂ =Â settings.method.trim().toUpperCase()Â //Â å¦‚æœæ˜¯GETÂ constÂ isGetRequestÂ =Â httpMethodÂ ===Â 'GET'Â //Â è¯·æ±‚å¤´Â constÂ jsonHeaders:Â Partial<JSONHeader>Â =Â {Â Accept:Â 'application/json'Â }Â //Â å¦‚æœä¸æ˜¯Â getÂ è®¾ç½®è¯·æ±‚å¤´Â ifÂ (!isGetRequestÂ &&Â data)Â jsonHeaders['Content-Type']Â =Â 'application/json'Â //Â æ”¶é›†æœ€åçš„headersé…ç½®Â settings.headersÂ =Â Object.assign({},Â jsonHeaders,Â settings.headers)Â //Â è·å–queryå‚æ•°çš„keyÂ constÂ paramKeysÂ =Â isGetRequestÂ &&Â dataÂ ?Â Object.keys(data)Â :Â []Â //Â è·å–queryå‚æ•°çš„å€¼Â constÂ getValueÂ =Â (key:Â keyofÂ T)Â =>Â (dataÂ ?Â data[key]Â :Â '')Â //Â è·å–queryÂ key=valueÂ constÂ toPairÂ =Â (key:Â string)Â =>Â keyÂ +Â '='Â +Â encodeURIComponent(getValue(keyÂ asÂ keyofÂ T)Â asÂ string)Â //Â ç”ŸæˆÂ key=value&key=valueÂ çš„queryå‚æ•°Â constÂ paramsÂ =Â ()Â =>Â paramKeys.map(toPair).join('&')Â //Â æ”¶é›†æœ€åçš„Â urlÂ é…ç½®Â constÂ requestUrlÂ =Â !paramKeys.lengthÂ ?Â urlÂ :Â urlÂ +Â (url.includes('?')Â ?Â '&'Â :Â '?')Â +Â params()Â //Â getæ²¡æœ‰bodyÂ settings.bodyÂ =Â !isGetRequestÂ &&Â dataÂ ?Â JSON.stringify(data)Â :Â nullÂ //Â åšä¸€å±‚res.json()Â constÂ toJsonÂ =Â (value:Â Response):Â Promise<ResponseObject>Â =>Â {Â //Â æ‹¿åˆ°ç¬¬ä¸€æ¬¡è¯·æ±‚çš„å€¼Â constÂ responseÂ =Â valueÂ constÂ contentTypeÂ =Â response.headers.get('content-type')Â constÂ isJsonÂ =Â !!contentTypeÂ &&Â /json|javascript/.test(contentType)Â constÂ textToObjÂ =Â (httpBody:Â string):Â ResponseObjectÂ =>Â ({Â Â Â ok:Â response.ok,Â Â Â error:Â !response.ok,Â Â Â status:Â response.status,Â Â Â contentType:Â contentType,Â Â Â bodyText:Â httpBody,Â Â Â response:Â responseÂ })Â constÂ errToObjÂ =Â (error:Â Error):Â ResponseObjectÂ =>Â ({Â Â Â ok:Â false,Â Â Â error:Â true,Â Â Â status:Â 500,Â Â Â contentType:Â contentType,Â Â Â bodyText:Â 'InvalidÂ JSONÂ ['Â +Â error.toString()Â +Â ']',Â Â Â response:Â responseÂ })Â returnÂ isJsonÂ Â Â ?Â //Â å¦‚æœæ˜¯json,ç”¨json()Â Â Â response.json().catch(errToObj)Â Â Â :Â response.text().then(textToObj)Â }Â Â Â //Â settingsåšä¸€ä¸‹åºåˆ—åŒ–Â Â Â constÂ settingsRequestInit:Â RequestInitÂ =Â JSON.parse(Â Â Â JSON.stringify(settings)Â )Â Â Â //Â æœ€ç»ˆè¯·æ±‚fetch,å†é€šè¿‡thenå°±èƒ½å–åˆ°ç¬¬äºŒå±‚resÂ Â Â returnÂ fetch(requestUrl,Â settingsRequestInit).then(toJson)Â }Â Â Â publicÂ get<T>(Â Â Â url:Â string,Â Â Â params?:Â T,Â Â Â options?:Â BaseOptionsÂ ):Â Promise<ResponseObject>Â {Â Â Â returnÂ this.request<T>('GET',Â url,Â params,Â options)Â }Â publicÂ post<T>(Â Â Â url:Â string,Â Â Â resource:Â T,Â Â Â options?:Â BaseOptionsÂ ):Â Promise<ResponseObject>Â {Â Â Â returnÂ this.request<T>('POST',Â url,Â resource,Â options)Â }Â publicÂ put<T>(Â Â Â url:Â string,Â Â Â resource:Â T,Â Â Â options?:Â BaseOptionsÂ ):Â Promise<ResponseObject>Â {Â Â Â returnÂ this.request<T>('PUT',Â url,Â resource,Â options)Â }Â publicÂ patch<T>(Â Â Â url:Â string,Â Â Â resource:Â T,Â Â Â options?:Â BaseOptionsÂ ):Â Promise<ResponseObject>Â {Â Â Â returnÂ this.request<T>('PATCH',Â url,Â resource,Â options)Â }Â publicÂ delete<T>(Â Â Â url:Â string,Â Â Â resource:Â T,Â Â Â options?:Â BaseOptionsÂ ):Â Promise<ResponseObject>Â {Â Â Â returnÂ this.request<T>('DELETE',Â url,Â resource,Â options)Â }}constÂ requestÂ =Â newÂ Request()exportÂ {Â request,Â RequestÂ }
```

#### å¦‚æœç”¨ axios è¯·æ±‚

request.ts

```
importÂ axiosÂ fromÂ 'axios'importÂ {Â AxiosInstanceÂ }Â fromÂ 'axios'importÂ {Â errorHandle,Â processData,Â successHandleÂ }Â fromÂ './resInterceptions'importÂ {Â defaultRequestInterceptionÂ }Â fromÂ './reqInterceptions'constÂ TIMEOUTÂ =Â 5Â *Â 1000classÂ RequestÂ {Â instance:Â AxiosInstanceÂ constructor()Â {Â Â Â this.instanceÂ =Â axios.create()Â Â Â this.init()Â }Â privateÂ init()Â {Â Â Â this.setDefaultConfig()Â Â Â this.reqInterceptions()Â Â Â this.resInterceptions()Â }Â privateÂ setDefaultConfig()Â {Â Â Â this.instance.defaults.baseURLÂ =Â import.meta.env.VITE_BASE_URLÂ Â Â this.instance.defaults.timeoutÂ =Â TIMEOUTÂ }Â privateÂ reqInterceptions()Â {Â Â Â this.instance.interceptors.request.use(defaultRequestInterception)Â }Â privateÂ resInterceptions()Â {Â Â Â this.instance.interceptors.response.use(processData)Â Â Â this.instance.interceptors.response.use(successHandle,Â errorHandle)Â }}exportÂ defaultÂ newÂ Request().instance
```

reqInterceptions.ts

```
importÂ typeÂ {Â InternalAxiosRequestConfigÂ }Â fromÂ 'axios'constÂ defaultRequestInterceptionÂ =Â (config:Â InternalAxiosRequestConfig)Â =>Â {Â //Â TODO:Â å…¨å±€è¯·æ±‚æ‹¦æˆªå™¨:Â æ·»åŠ tokenÂ returnÂ config}exportÂ {Â defaultRequestInterceptionÂ }
```

resInterceptions.ts

```
import { AxiosError, AxiosResponse } from 'axios'
import { checkStatus } from './checkStatus'
const processData = (res: AxiosResponse) => {
 // TODO:ç»Ÿä¸€å¤„ç†æ•°æ®ç»“æ„
 return res.data
}
const successHandle = (res: AxiosResponse) => {
 // TODO:å¤„ç†ä¸€äº›æˆåŠŸå›è°ƒï¼Œä¾‹å¦‚è¯·æ±‚è¿›åº¦æ¡
 return res.data
}
const errorHandle = (err: AxiosError) => {
 if (err.status) checkStatus(err.status)
 else return Promise.reject(err)
}
export { processData, successHandle, errorHandle }
```

checkStatus.ts

```
exportÂ functionÂ checkStatus(status:Â number,Â msg?:Â string):Â voidÂ {Â letÂ errMessageÂ =Â ''Â switchÂ (status)Â {Â Â Â caseÂ 400:Â Â Â Â Â errMessageÂ =Â `${msg}`Â Â Â Â Â breakÂ Â Â caseÂ 401:Â Â Â Â Â breakÂ Â Â caseÂ 403:Â Â Â Â Â errMessageÂ =Â ''Â Â Â Â Â breakÂ Â Â //Â 404è¯·æ±‚ä¸å­˜åœ¨Â Â Â caseÂ 404:Â Â Â Â Â errMessageÂ =Â ''Â Â Â Â Â breakÂ Â Â caseÂ 405:Â Â Â Â Â errMessageÂ =Â ''Â Â Â Â Â breakÂ Â Â caseÂ 408:Â Â Â Â Â errMessageÂ =Â ''Â Â Â Â Â breakÂ Â Â caseÂ 500:Â Â Â Â Â errMessageÂ =Â ''Â Â Â Â Â breakÂ Â Â caseÂ 501:Â Â Â Â Â errMessageÂ =Â ''Â Â Â Â Â breakÂ Â Â caseÂ 502:Â Â Â Â Â errMessageÂ =Â ''Â Â Â Â Â breakÂ Â Â caseÂ 503:Â Â Â Â Â errMessageÂ =Â ''Â Â Â Â Â breakÂ Â Â caseÂ 504:Â Â Â Â Â errMessageÂ =Â ''Â Â Â Â Â breakÂ Â Â caseÂ 505:Â Â Â Â Â errMessageÂ =Â ''Â Â Â Â Â breakÂ Â Â default:Â }Â ifÂ (errMessage)Â {Â Â Â //Â TODO:é”™è¯¯æç¤ºÂ Â Â //Â createErrorModal({title:Â errMessage})Â }}``Â api.ts```tsimportÂ requestÂ fromÂ '@/services/axios/request'importÂ {Â ReqTitleÂ }Â fromÂ './type'exportÂ constÂ requestTitleÂ =Â ():Â Promise<ReqTitle>Â =>Â {Â returnÂ request.get('/api/ä¸€ä¸ªè·å–titleçš„æ¥å£')}
```

type.ts

```
exportÂ typeÂ ReqTitleÂ =Â {Â title:Â string}
```

#### é…ç½® mobxï¼ˆå¯ä¸ç”¨ï¼‰

*   å®‰è£…`pnpm i mobx mobx-react-lite`
    
*   é…ç½®`model->index.ts`
    

```
importÂ {Â makeAutoObservableÂ }Â fromÂ 'mobx'constÂ storeÂ =Â makeAutoObservable({Â Â count:Â 1,Â Â setCount:Â (count:Â number)Â =>Â {Â Â Â Â store.countÂ =Â countÂ Â }})exportÂ defaultÂ store
```

*   ä½¿ç”¨æ–¹æ³•ä¸¾ä¸ª ğŸŒ°
    

```
import store from '@/model'
import { Button } from 'antd'
import { observer, useLocalObservable } from 'mobx-react-lite'
const Home: React.FC = () => {
 const localStore = useLocalObservable(() => store)
 return (
   <div>
     <Button>Antd</Button>
     <h1>{localStore.count}</h1>
   </div>
 )
}
export default observer(Home)
```

#### é…ç½® changelogï¼ˆå¯ä¸ç”¨ï¼‰

`pnpm i conventional-changelog-cli \-D`

ç¬¬ä¸€æ¬¡å…ˆæ‰§è¡Œ`conventional-changelog \-**p** angular \-**i** CHANGELOG.md \-s \-r 0`å…¨éƒ¨ç”Ÿæˆä¹‹å‰çš„æäº¤ä¿¡æ¯

é…ç½®ä¸ªè„šæœ¬ï¼Œç‰ˆæœ¬å˜åŒ–æ‰“ tag çš„æ—¶å€™å¯ä»¥ä½¿ç”¨

```
"scripts":Â {Â "changelog":Â "conventional-changelogÂ -pÂ angularÂ -iÂ CHANGELOG.mdÂ -s"}
```

#### é…ç½® editorConfig ç»Ÿä¸€ç¼–è¾‘å™¨ï¼ˆå¯ä¸ç”¨ï¼‰

> editorConfigï¼Œå¯ä»¥åŒæ­¥ç¼–è¾‘å™¨å·®å¼‚ï¼Œå…¶å®å¤§éƒ¨åˆ†å·¥ä½œ prettier åšäº†ï¼Œéœ€è¦ä¸‹è½½ editorConfig vscode æ’ä»¶ æœ‰ç¼–è¾‘å™¨å·®å¼‚çš„æ‰é…ç½®ä¸€ä¸‹ï¼Œå¦‚æœå›¢é˜Ÿéƒ½æ˜¯ vscode å°±æ²¡å¿…è¦äº†

*   é…ç½®`editorconfig`
    

```
#ä¸å†å‘ä¸ŠæŸ¥æ‰¾.editorconfigrootÂ =Â true#Â *è¡¨ç¤ºå…¨éƒ¨æ–‡ä»¶[*]#ç¼–ç charsetÂ =Â utf-8#ç¼©è¿›æ–¹å¼indent_styleÂ =Â space#ç¼©è¿›ç©ºæ ¼æ•°indent_sizeÂ =Â 2#æ¢è¡Œç¬¦lfend_of_lineÂ =Â lf
```

#### é…ç½® stylelint æ£€æŸ¥ CSS è§„èŒƒï¼ˆå¯ä¸ç”¨ï¼‰

> stylelint å¤„ç† css æ›´ä¸“ä¸š, ä½†æ˜¯ç”¨äº† tailwind ä¹‹åç”¨å¤„ä¸å¤§äº†

*   å®‰è£…ï¼š`pnpm i \-D stylelint stylelint-config-standard`
    
*   é…ç½®`.stylelintrc.json`
    

```
{Â "extends":Â "stylelint-config-standard"}
```

*   é…ç½®`.vscode>settings.json`ï¼Œé…ç½®å vscode ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ– css
    

```
{Â "editor.codeActionsOnSave":Â {Â Â Â "source.fixAll.eslint":Â true,Â //Â æ¯æ¬¡ä¿å­˜çš„æ—¶å€™å°†ä»£ç æŒ‰ç…§Â eslintÂ æ ¼å¼è¿›è¡Œä¿®å¤Â Â Â "source.fixAll.stylelint":Â trueÂ //è‡ªåŠ¨æ ¼å¼åŒ–stylelintÂ },Â "editor.formatOnSave":Â true,Â //è‡ªåŠ¨æ ¼å¼åŒ–Â "editor.defaultFormatter":Â "esbenp.prettier-vscode"Â //é£æ ¼ç”¨prettier}
```

*   æŒæ¡`stylelintå‘½ä»¤è¡Œ`
    

`npx stylelint "**/*.css" --fix//æ ¼å¼åŒ–æ‰€æœ‰css,è‡ªåŠ¨ä¿®å¤css`

#### ä¸‹é¢æ˜¯ h5 é¡¹ç›®ï¼ˆå¯ä¸ç”¨ï¼‰

#### é…ç½®`vconsole`ï¼ˆh5ï¼‰

*   å®‰è£…`pnpm i vconsole \-D`
    
*   `main.tsx`é‡Œæ–°å¢
    

```
import VConsole from 'vconsole'
new VConsole({ theme: 'dark' })
```

#### antd æ¢æˆ mobile antdï¼ˆh5ï¼‰

*   `pnpm remove antd`
    
*   `pnpm add antd-mobile`
    

#### é…ç½® postcss-px-to-viewportï¼ˆåºŸå¼ƒï¼‰

*   æŠŠè“æ¹–è®¾è®¡ç¨¿å°ºå¯¸å›ºå®šä¸º 1000px(100px æˆ‘è¯•è¿‡è“æ¹–ç›´æ¥ç™½å±äº†)ï¼Œç„¶åä½ ç‚¹å‡ºæ¥çš„å€¼æ¯”å¦‚æ˜¯ 77pxï¼Œé‚£ä½ åªéœ€è¦å†™ 7.7vw å°±å®ç°äº†è‡ªé€‚åº”å¸ƒå±€ï¼Œå°±ä¸å†éœ€è¦è¿™ä¸ªæ’ä»¶äº†
    
*   å®‰è£…ï¼š`pnpm i postcss-px-to-viewport \-D`
    
*   é…ç½®`postcss.config.cjs`
    

```
module.exportsÂ =Â {Â plugins:Â {Â 'postcss-px-to-viewport':Â {Â Â Â landscape:Â false,Â //Â æ˜¯å¦æ·»åŠ æ ¹æ®Â landscapeWidthÂ ç”Ÿæˆçš„åª’ä½“æŸ¥è¯¢æ¡ä»¶Â @mediaÂ (orientation:Â landscape)Â Â Â landscapeUnit:Â 'vw',Â //Â æ¨ªå±æ—¶ä½¿ç”¨çš„å•ä½Â Â Â landscapeWidth:Â 568,Â //Â æ¨ªå±æ—¶ä½¿ç”¨çš„è§†å£å®½åº¦Â Â Â unitToConvert:Â 'px',Â //Â è¦è½¬åŒ–çš„å•ä½Â Â Â viewportWidth:Â 750,Â //Â UIè®¾è®¡ç¨¿çš„å®½åº¦Â Â Â unitPrecision:Â 5,Â //Â è½¬æ¢åçš„ç²¾åº¦ï¼Œå³å°æ•°ç‚¹ä½æ•°Â Â Â propList:Â ['*'],Â //Â æŒ‡å®šè½¬æ¢çš„csså±æ€§çš„å•ä½ï¼Œ*ä»£è¡¨å…¨éƒ¨csså±æ€§çš„å•ä½éƒ½è¿›è¡Œè½¬æ¢Â Â Â viewportUnit:Â 'vw',Â //Â æŒ‡å®šéœ€è¦è½¬æ¢æˆçš„è§†çª—å•ä½ï¼Œé»˜è®¤vwÂ Â Â fontViewportUnit:Â 'vw',Â //Â æŒ‡å®šå­—ä½“éœ€è¦è½¬æ¢æˆçš„è§†çª—å•ä½ï¼Œé»˜è®¤vwÂ Â Â selectorBlackList:Â ['special'],Â //Â æŒ‡å®šä¸è½¬æ¢ä¸ºè§†çª—å•ä½çš„ç±»åï¼ŒÂ Â Â minPixelValue:Â 1,Â //Â é»˜è®¤å€¼1ï¼Œå°äºæˆ–ç­‰äº1pxåˆ™ä¸è¿›è¡Œè½¬æ¢Â Â Â mediaQuery:Â true,Â //Â æ˜¯å¦åœ¨åª’ä½“æŸ¥è¯¢çš„cssä»£ç ä¸­ä¹Ÿè¿›è¡Œè½¬æ¢ï¼Œé»˜è®¤falseÂ Â Â replace:Â true,Â //Â æ˜¯å¦è½¬æ¢åç›´æ¥æ›´æ¢å±æ€§å€¼Â Â Â exclude:Â [/node_modules/]Â //Â è®¾ç½®å¿½ç•¥æ–‡ä»¶ï¼Œç”¨æ­£åˆ™åšç›®å½•ååŒ¹é…Â Â }Â }}
```

### å‚è€ƒèµ„æ–™

[1]

https://www.conventionalcommits.org/en/v1.0.0/

å…³äºæœ¬æ–‡  

ä½œè€…ï¼šimber
========

https://juejin.cn/post/7241875166887444541

æœ€å
--

æ¬¢è¿å…³æ³¨ã€å‰ç«¯ç“¶å­å›ã€‘âœ¿âœ¿ãƒ½ (Â°â–½Â°) ãƒâœ¿

å›å¤ã€Œäº¤æµã€ï¼Œå¹å¹æ°´ã€èŠèŠæŠ€æœ¯ã€ååæ§½ï¼

å›å¤ã€Œé˜…è¯»ã€ï¼Œæ¯æ—¥åˆ·åˆ·é«˜è´¨é‡å¥½æ–‡ï¼

å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œã€Œåœ¨çœ‹ã€æ˜¯æœ€å¤§çš„æ”¯æŒï¼

```
æœ€åä¸è¦å¿˜äº†ç‚¹èµå‘¦ï¼

```