> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/hvrZjneQN-EMIMZveomK9g)

èƒŒæ™¯
==

ç›®å‰ä½œè€…æ‰€åœ¨çš„ä¸šåŠ¡æ­£åœ¨å‡çº§ Antd5.0ï¼Œä¸å¾—ä¸è¯´ Antd5.0 çœŸçš„å¤ªé¦™äº†ï¼Œä½†æ˜¯ç”±äºå›¢é˜Ÿçš„ UE è§„èŒƒè¿›è¡Œäº†å¤§æ”¹ç‰ˆï¼ŒAntd5.0 æ‰€æœ‰çš„ç»„ä»¶å¿…é¡»å¯¹é½æœ€æ–°çš„è§„èŒƒï¼Œå› æ­¤å°±éœ€è¦å¯¹ Antd5.0 ç»„ä»¶åšä¸»é¢˜å®šåˆ¶ã€‚

ç°çŠ¶
==

ç›®å‰é’ˆå¯¹é¡¹ç›®ä¸­ä½¿ç”¨çš„ antd é«˜é¢‘ç»„ä»¶è¿›è¡Œäº†æ¢³ç†ï¼Œå¹¶ä¸”æ ¹æ®è§„èŒƒåŸºäº design token å¯¹è¿™äº›é«˜é¢‘ç»„ä»¶è¿›è¡Œæ ·å¼å®šåˆ¶ï¼Œå¯¹äºä¸»é¢˜è‰²ã€åœ†è§’ã€è¾¹æ¡†ã€å­—ä½“ç­‰ç”¨æˆ·å…³æ³¨åº¦é«˜çš„ä¸»é¢˜éƒ½å·²ç»æ»¡è¶³å›¢é˜Ÿè§„èŒƒã€‚

è™½ç„¶ Design Token æä¾›äº†éå¸¸å¼ºå¤§çš„æ‹“å±•èƒ½åŠ›ï¼Œä½†æ˜¯åŒæ ·å®ƒä¹Ÿæœ‰é™åˆ¶ï¼Œä¾‹å¦‚å½“æŸäº›ç»„ä»¶ï¼ˆbuttonã€selectï¼‰çš„ä¸»é¢˜å®ç°ä¸èƒ½å•çº¯ä¾èµ–æŸç§ Token æ—¶ï¼Œå¼€å‘è€…å°±éœ€è¦é€šè¿‡æ ·å¼è¦†ç›–çš„æ–¹å¼å»æ”¹å†™ antd çš„æ ·å¼ä»¥æ»¡è¶³éœ€æ±‚ã€‚

ç›®æ ‡
==

*   ä»é«˜é¢‘ç»„ä»¶ä¸­æ¢³ç†å‡ºéœ€è¦è¿›è¡Œæ ·å¼è¦†ç›–çš„ç»„ä»¶åŠå…¶éœ€è¦è¦†ç›–ç‚¹ã€‚
    
*   è°ƒç ”å‡ºä¸€å¥—å…·å¤‡é«˜æ€§èƒ½ã€é«˜å¯æ‰©å±•ã€å…¼å®¹æ€§å¼ºçš„æ ·å¼è¦†ç›–æ–¹æ¡ˆã€‚
    

Antd ä¸»é¢˜å®šåˆ¶æ¼”è¿›
===========

Antd4.x æ—¶ä»£
----------

### ç®€å•æ¦‚è¦

åœ¨ antd4.x æ—¶ä»£ï¼Œantd çš„æ ·å¼ä½¿ç”¨äº† less ä½œä¸ºå¼€å‘è¯­è¨€ï¼Œå…¶å†…éƒ¨å®šä¹‰äº†ä¸€ç³»åˆ—çš„å…¨å±€ / ç»„ä»¶çš„æ ·å¼å˜é‡ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚å»è¦†ç›–è¿™äº›æ ·å¼å˜é‡ã€‚

```
@primary-color: #1890ff; // å…¨å±€ä¸»è‰²
@link-color: #1890ff; // é“¾æ¥è‰²
@success-color: #52c41a; // æˆåŠŸè‰²
@warning-color: #faad14; // è­¦å‘Šè‰²
@error-color: #f5222d; // é”™è¯¯è‰²
@font-size-base: 14px; // ä¸»å­—å·
```

å¯¹äºæ ·å¼å˜é‡çš„è¦†ç›–ï¼ŒåŸç†ä¸Šæ˜¯ä½¿ç”¨ less æä¾›çš„ modifyVars æ–¹å¼è¿›è¡Œå˜é‡çš„è¦†ç›–ï¼Œä»¥ webpack ä¸ºä¾‹ï¼š

```
// webpack.config.js
module.exports = {
  rules: [{
    test: /\.less$/,
    use: [{
      loader: 'style-loader',
    }, {
      loader: 'css-loader',
    }, {
      loader: 'less-loader',
+     options: {
+       lessOptions: {
+         modifyVars: {
+           'primary-color': '#1DA57A',
+           'link-color': '#1DA57A',
+           'border-radius-base': '2px',
+         },
+         javascriptEnabled: true
+       }
+     }
    }]
  }]
}
```

### ä»€ä¹ˆæ˜¯ CSS å˜é‡ï¼Ÿ

æ—©åœ¨ 2012 å¹´ W3C å°±å·²ç»å…¬å¸ƒäº† CSS å˜é‡çš„é¦–ä¸ªå…¬å¼€è‰æ¡ˆï¼›2017 å¹´ 3 æœˆå¾®è½¯ Edge æµè§ˆå™¨ä¹Ÿå®£å¸ƒæ”¯æŒ CSS å˜é‡ï¼Œæ­¤æ—¶æ‰€æœ‰ä¸»è¦æµè§ˆå™¨éƒ½å·²ç»æ”¯æŒè¿™ä¸ª CSS æ–°åŠŸèƒ½ã€‚

CSS å˜é‡æœ¬è´¨æ˜¯å®šä¹‰ä¸€ç³»åˆ—æ ·å¼å±æ€§ï¼Œå¯ä»¥è¢«å…¶ä»– CSS å±æ€§å¼•ç”¨ï¼Œå¹¶ä¸”æä¾›äº† JavaScript åŸºå±‚ API è¿›è¡Œç®¡ç†ï¼Œå› æ­¤ CSS å˜é‡å¤©ç”Ÿå°±æ˜¯ä¸º**ã€Œä¸»é¢˜å®šåˆ¶ã€**è€Œç”Ÿçš„ï¼Œå…¸å‹é¡µé¢å°±æ˜¯ react.dev å’Œ Mantine çš„å®˜ç½‘ã€‚

é™¤æ­¤ä¹‹å¤– CSS å˜é‡ä¸€ä¸ªæœ€å¤§çš„ä¼˜åŠ¿åœ¨äº**ã€Œæ˜¯ç¼–è¯‘æ—¶ï¼Œä¸æ˜¯è¿è¡Œæ—¶ã€**ï¼Œè¿™ä¸ªç‰¹æ€§åœ¨ä¸»é¢˜å®šåˆ¶ä¸­å°¤ä¸ºé‡è¦ï¼Œä¸»è¦ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ï¼š

*   åˆ‡æ¢ä¸»é¢˜ä¸ä¼šå¡é¡¿
    
*   åˆ‡æ¢ä¸»é¢˜åèƒ½å¤Ÿæ— ç¼åˆ·æ–°ï¼ˆé™æ€ç«™ç‚¹åˆ‡æ¢åˆ°æš—è‰²ååˆ·æ–°ï¼Œä¸ä¼šä»äº®è‰²å†å˜å›æš—è‰²ï¼‰
    

è¿™ä¸¤ä¸ªåœºæ™¯åœ¨ cssinjs è¿™ç§**ã€Œè¿è¡Œæ—¶ã€**æ–¹æ¡ˆä¸‹æ˜¯æ— æ³•å®ç°çš„ï¼Œå‰è€…ä¸èƒ½å®ç°æ˜¯å› ä¸ºåœ¨åˆ‡æ¢ä¸»é¢˜æ—¶æ ·å¼éœ€è¦é‡æ–°è¿›è¡Œåºåˆ—åŒ–ï¼Œåè€…ä¸èƒ½æ— ç¼åˆ·æ–°æ˜¯å› ä¸ºåˆ·æ–°åç³»ç»Ÿå°±æ— æ³•ä¿ç•™åˆ‡æ¢åçš„ä¸»é¢˜æ ·å¼ï¼Œéœ€è¦é‡æ–°ç”Ÿæˆï¼‰ã€‚

### CSS å˜é‡ä¸‹çš„ Antd ä¸»é¢˜å®šåˆ¶ä¸è¶³

*   ä¸å¤Ÿçµæ´»
    
    ä»¥ CSS å˜é‡ä¸ºåŸºç¡€çš„ä¸»é¢˜ç³»ç»Ÿ / æ ·å¼å¼•æ“è™½ç„¶èƒ½å¤Ÿå¸¦æ¥æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œä½†åŒæ—¶ä¹Ÿå°±ä¸§å¤±äº†ä¸»é¢˜å®šåˆ¶çš„**ã€Œçµæ´»æ€§ã€**ï¼Œæ¯”å¦‚ä¸æ”¯æŒä¸»é¢˜åµŒå¥—ã€å¤šä¸»é¢˜å¹¶å­˜çš„èƒ½åŠ›ï¼Œæ¯”å¦‚è¯´ä¸‹é¢è¿™ä¸ªå…¸å‹çš„åœºæ™¯ï¼š
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/lCQLg02gtibtib3ShShaxtrCM8eELtkRe5wA49td7SdVKgHOXKl3FLHIxic6q9pKkDo8K7qAkkgBgRyp9Ksv6Vbdg/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/mmbiz_png/lCQLg02gtibtib3ShShaxtrCM8eELtkRe5w4D5TldNiavu7NNj1ttFbSSJfR5JjmG4Qmaicia2AZ4H3IjpOrBMTHKKA/640?wx_fmt=png&from=appmsg)image.png
    
    å¯ä»¥çœ‹åˆ°ç”±äºæš—è‰²æ¨¡å¼ä¸‹ Modal çš„åº•è‰²ä¸é¡µé¢åŸºç¡€çš„ Layout åº•è‰²ä¸åŒï¼Œæœ€ç»ˆå‘ˆç°çš„æ„Ÿè§‰å°±æ˜¯ table â€œé™·â€ è¿›å»äº†ä¸€å±‚ï¼Œä½†è¿™ç§åœºæ™¯åœ¨ antd å±‚é¢å¾€å¾€æ— èƒ½ä¸ºåŠ›ï¼Œå› ä¸ºç»„ä»¶æœ¬èº«å¹¶ä¸é™åˆ¶ä¸šåŠ¡åº”ç”¨å¦‚ä½•ä½¿ç”¨ç»„ä»¶ï¼Œå› æ­¤å°±éœ€è¦å¼€å‘è€…è‡ªå·±å»åšæ ·å¼è¦†ç›–ã€‚è¿™ç¯‡æ–‡æ¡£ä¸­å®˜æ–¹æä¾›äº†å¾ˆå¤šå…³äºçµæ´»æ€§è®²è§£çš„ä¾‹å­ã€‚
    

Antd5.x æ—¶ä»£
----------

### ç®€å•æ¦‚è¦

åœ¨ 2022 å¹´ 11 æœˆ 18 æ—¥ï¼ŒAntd å‘å¸ƒäº† Ant Design 5.0 çš„æ­£å¼ç‰ˆæœ¬ï¼Œä¸ºäº†æé«˜ä¸»é¢˜å®šåˆ¶çš„äº†çµæ´»æ€§ï¼Œ Antd å°†åŸæœ‰çš„ less æ–¹æ¡ˆæ›¿æ¢ä¸º css-in-js æ–¹æ¡ˆï¼Œä¹Ÿå› æ­¤è¯ç”Ÿäº†ä¸€å¥—æ–°çš„ä¸»é¢˜å®šåˆ¶æ–¹æ¡ˆâ€”â€” Design Token æ¨¡å‹ï¼Œæ”¯æŒç”¨æˆ·å»çµæ´»çš„å®ç°ä¸»é¢˜åµŒå¥—ã€å¤šä¸»é¢˜å¹¶å­˜ã€‚

> â
> 
> ğŸ”‘ å…³é”®ç‚¹ï¼šä¸»é¢˜é…ç½®ä»åŸæ¥çš„ç¼–è¯‘æ—¶é…ç½®å˜æˆäº†ä»£ç é‡Œçš„è¿è¡Œæ—¶é…ç½®ã€‚
> 
> â

### ä»€ä¹ˆæ˜¯ CSS-in-JSï¼Ÿ

css-in-js æ˜¯ä¸€ä¸ªå°† CSS æ ·å¼å†™åœ¨ Javascript æ–‡ä»¶ä¸­çš„æŠ€æœ¯ï¼Œæ—¨åœ¨è§£å†³ CSS è‡ªèº«çš„å±€é™æ€§ï¼Œæ¯”å¦‚å˜é‡å®šä¹‰ã€æ¡ä»¶åˆ¤æ–­ã€å‡½æ•°è°ƒç”¨ç­‰ JavaScript è¯­è¨€æ‰æœ‰çš„ç‰¹æ€§ï¼Œé€šè¿‡ css-in-js ä½¿å¾—åŸæœ‰ CSS æ ·å¼å˜å¾—æ›´çµæ´»å¯æ‹“å±•ã€‚åœ¨ React ç¤¾åŒºä¸­ï¼Œç›®å‰æœ€æµè¡Œçš„ css-in-js åº“æ˜¯ styled-components å’Œ Emotionã€‚

css-in-js æœ€å…³é”®çš„ç‰¹æ€§å°±æ˜¯**ã€Œè¿è¡Œæ—¶ã€**ï¼Œè¿™æ„å‘³ç€ä½¿ç”¨ css-in-js ç¼–å†™çš„æ ·å¼åªæœ‰åœ¨åº”ç”¨è¿è¡Œæ—¶æ‰ä¼šå»è§£é‡Šå¹¶åº”ç”¨ã€‚

### CSS-in-JS çš„ä¼˜ç‚¹å’Œç¼ºé™·

**ã€Œä¼˜åŠ¿ï¼šã€**

*   æ²¡æœ‰å…¨å±€æ ·å¼å†²çª
    
    å°±åƒ js å¤©ç„¶æ”¯æŒæ¨¡å—åŒ–çš„å¥½å¤„ä¸€æ ·ï¼ŒåŸç”Ÿ CSS å› ä¸ºæ²¡æœ‰æ¨¡å—åŒ–çš„èƒ½åŠ›ï¼Œå’Œå®¹æ˜“å¯¼è‡´å…¨å±€æ ·å¼æ±¡æŸ“ï¼Œå¦‚æœæ ·å¼ä¸æ˜¯ç‰¹æ„ç”¨ BEM çš„æ–¹å¼å‘½åï¼Œæˆ–è€…å€ŸåŠ© css module çš„èƒ½åŠ›ï¼Œæƒ³è¦é¿å…æ ·å¼å†²çªå°±åªèƒ½ç”¨ css-in-jsã€‚
    
*   è‡ªå¸¦ tree-shaking åŠŸèƒ½
    
    ç”±äº css-in-js æ”¯æŒæ¨¡å—åŒ–çš„æ ·å¼å®šä¹‰ï¼Œæ¯ä¸ªç»„ä»¶çš„æ ·å¼ä¼šè¢«å®šä¹‰æˆä¸€ä¸ªå•ç‹¬çš„æ¨¡å—ï¼Œè€Œæ„å»ºå·¥å…·ä¼šå¯¹å®šä¹‰çš„æ ·å¼æ¨¡å—è¿›è¡Œé™æ€åˆ†æï¼Œä½¿å¾—æœªä½¿ç”¨çš„æ ·å¼æ¨¡å—ä¸ä¼šæ‰“åŒ…åˆ°æœ€ç»ˆçš„äº§ç‰©ä¸­ã€‚
    
*   æ–¹ä¾¿æ ·å¼ç®¡ç†
    
    css-in-js ä¼šæŠŠæ ·å¼å’Œç»„ä»¶ç»‘å®šåœ¨ä¸€èµ·ï¼Œå½“è¿™ä¸ªç»„ä»¶è¦è¢«åˆ é™¤æ‰çš„æ—¶å€™ï¼Œç›´æ¥æŠŠè¿™äº›ä»£ç åˆ é™¤æ‰å°±å¥½äº†ï¼Œä¸ç”¨æ‹…å¿ƒåˆ æ‰çš„æ ·å¼ä»£ç ä¼šå¯¹é¡¹ç›®çš„å…¶ä»–ç»„ä»¶æ ·å¼äº§ç”Ÿå½±å“ï¼ˆcss-modules ä¹Ÿä¸€æ ·èƒ½åšåˆ°ï¼Œåªæ˜¯å¿…é¡»å•ç‹¬æ‹†ä¸€ä¸ªæ ·å¼æ–‡ä»¶ï¼‰ã€‚
    
*   çµæ´»æ€§é«˜
    
    css-in-js å…è®¸å†æ ·å¼ä¸­ä½¿ç”¨ Javascript å˜é‡ï¼Œä»è€Œä½¿ç»„ä»¶çš„æ ·å¼å…·å¤‡é«˜å¯å®šåˆ¶åŒ–çš„èƒ½åŠ›ã€‚
    

**ã€Œç¼ºç‚¹ï¼šã€**

*   css-in-js å¢åŠ äº†è¿è¡Œæ—¶å¼€é”€
    
    ç»„ä»¶æ¯æ¬¡æ¸²æŸ“æ—¶ï¼Œcss-in-js åº“å¿…é¡»å°†æ ·å¼**ã€Œåºåˆ—åŒ–ã€**ä¸ºå¯è¢«æ’å…¥åˆ°é¡µé¢çš„ CSS æ ·å¼ï¼Œæ˜¾ç„¶è¿™éœ€è¦é¢å¤–çš„ CPU æ¶ˆè€—ï¼Œå°¤å…¶æ˜¯åœ¨ React 18 çš„å¹¶å‘æ¨¡å¼ä¸‹ï¼Œä¼šå­˜åœ¨æ— æ³•è§£å†³çš„æ€§èƒ½é—®é¢˜ã€‚
    
    React æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜ã€Hook è®¾è®¡è€… Sebastian MarkbÃ¥ge åœ¨ React 18 å·¥ä½œç»„çš„è¿™ç¯‡éå¸¸æœ‰ä»·å€¼çš„è®¨è®ºä¸­è¯´é“ï¼š
    
    > â
    > 
    > ğŸ“¢ åœ¨å¹¶å‘æ¸²æŸ“ä¸­ï¼ŒReact å¯ä»¥åœ¨æ¸²æŸ“ä¹‹é—´è®©å‡ºçº¿ç¨‹ç»™æµè§ˆå™¨ã€‚å¦‚æœä½ åœ¨ä¸€ä¸ªç»„ä»¶ä¸­æ’å…¥æ–°çš„ CSS, ç„¶å React è®©å‡ºçº¿ç¨‹ï¼Œæµè§ˆå™¨å¿…é¡»æ£€æŸ¥è¿™äº› CSS æ˜¯å¦é€‚ç”¨äºç°æœ‰çš„æ ‘ã€‚æ‰€ä»¥å®ƒé‡æ–°è®¡ç®—æ ·å¼è§„åˆ™ã€‚ç„¶å React æ¸²æŸ“ä¸‹ä¸€ä¸ªç»„ä»¶ï¼Œç„¶åè¿™ä¸ªç»„ä»¶å‘ç°æ–° CSSï¼Œé‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹ä¼šå¾ªç¯å¾€å¤ã€‚
    > 
    > â
    
    **ã€Œæ€»ç»“æ¥è¯´ï¼Œcss-in-jsã€** **ã€Œåœ¨è¿è¡Œæ—¶æ’å…¥æ ·å¼ä¼šé˜»å¡ React çš„æ¸²æŸ“ï¼Œè¿›è€Œæ‹–æ…¢æ•´ä¸ªé¡µé¢çš„æ¸²æŸ“é€Ÿåº¦ï¼Œå½“ç»„ä»¶é¢‘ç¹çš„æ¸²æŸ“æ—¶å°±ä¼šå‡ºç°æ˜æ˜¾çš„æ€§èƒ½ç“¶é¢ˆã€‚ã€**
    
    è¿™ä¸ªé—®é¢˜ç›®å‰çœ‹æ¥æ˜¯æ— è§£çš„ï¼Œå› ä¸ºè¿è¡Œæ—¶ css-in-js åº“çš„å·¥ä½œæ–¹å¼å°±æ˜¯ç»„ä»¶æ¸²æŸ“æ—¶æ’å…¥æ–°æ ·å¼è§„åˆ™ï¼Œè¿™åœ¨æ ¹æœ¬ä¸Šå’Œæ€§èƒ½æ˜¯å¯¹ç«‹çš„ã€‚
    
*   css-in-js å¢åŠ äº†åŒ…ä½“ç§¯
    
    ç›¸æ¯”äºåŸç”Ÿ CSS å†™æ³•æˆ–è€… CSS module æ–¹æ¡ˆæ¥è¯´ï¼Œ**ã€Œcss-in-jsã€** ä¼šå¼•å…¥è€Œå¤–çš„è¿è¡Œæ—¶ä»£ç ï¼ˆEmotion æ˜¯ 7.9 kB å‹ç¼©åï¼Œstyled-components æ˜¯ 12.7 kBï¼‰ã€‚
    
*   å¤šä¸ªä¸åŒï¼ˆç”šè‡³æ˜¯ç›¸åŒï¼‰ç‰ˆæœ¬çš„ css-in-js åº“åŒæ—¶åŠ è½½æ—¶å¯èƒ½å¯¼è‡´é”™è¯¯ï¼ˆexample issueï¼‰ã€‚
    
*   ä¸åŒ React ç‰ˆæœ¬çš„ SSRï¼Œcss-in-js éœ€è¦é€‚é…ä¸åŒçš„å®ç°ï¼ˆexample issueï¼‰
    

å°ç»“
--

**ã€Œcss-in-jsã€** è‡ªèº«çš„è®¾è®¡æ–¹å‘æ˜¯å¯¹çš„ï¼Œå³æŠŠ CSS ä¸ JS ç›¸ç»“åˆï¼Œä½¿å¾— CSS å˜å¾—æ›´åŠ çš„çµæ´»ï¼Œåœ¨ä¸€äº›éœ€è¦ç»„ä»¶æ ·å¼å…·å¤‡é«˜å¯å®šåˆ¶åŒ–èƒ½åŠ›çš„åœºæ™¯ä¸­èƒ½å‘æŒ¥å‡ºæœ€å¤§çš„ä¼˜åŠ¿ï¼Œè¿™ä¹Ÿæ˜¯ Antd5.0 ä¸å¯å‰²èˆçš„æœ€ä¸»è¦çš„åŸå› ï¼Œä½†å¤ªè¿‡çµæ´»çš„è¿è¡Œæ—¶ **ã€Œcss-in-jsã€** æ–¹æ¡ˆé‡åˆ°äº†å‡ ä¹ä¸å¯è§£çš„æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤ Antd ä¹Ÿéœ€è¦é¢ä¸´è¿™æ–¹é¢çš„æŒ‘æˆ˜ã€‚

Antd æ²¡æœ‰è€ƒè™‘è¿‡ CSS- in-JS çš„æ€§èƒ½é—®é¢˜å—ï¼Ÿ
=============================

CSS-in-JS æ€§èƒ½é—®é¢˜çš„æ ¹æº
-----------------

åœ¨ css-in-js ä¸­æ¯ä¸€æ®µ CSS éƒ½ä¼šæœ‰ä¸€ä¸ª hash å€¼ï¼Œç”¨æ¥ç¡®è®¤è¿™æ®µ CSS æ˜¯å¦å·²ç»æ’å…¥åˆ°é¡µé¢ï¼Œè€Œè¿™ä¸ª hash çš„ç”Ÿæˆæ–¹å¼ä¸€èˆ¬æ˜¯å°†è¿™æ®µå®Œæ•´çš„ CSS æ ·å¼è½¬æ¢æˆä¸€ä¸ª hash å€¼ã€‚æ¯”å¦‚åœ¨ styled-components ä¸­ï¼Œå®ƒç”Ÿæˆçš„æ ·å¼ä¼šè¢«æ’å…¥åˆ° style æ ‡ç­¾ä¸­ï¼Œè€Œè¿™ä¸ª style æ ‡ç­¾ä¸­çš„æ¯ä¸€ä¸ª className å°±æ˜¯æ ¹æ® CSS æ ·å¼ç”Ÿæˆçš„ hash å€¼ï¼Œæ¯ä¸ª hash å€¼éƒ½æ˜¯å”¯ä¸€çš„ã€‚

![](https://mmbiz.qpic.cn/mmbiz_png/lCQLg02gtibtib3ShShaxtrCM8eELtkRe5Sw8RVeRxJLTicnfiaEqd5zYGgRDO3FtaA45Z099EibAZ8jKvcjribJD31A/640?wx_fmt=png&from=appmsg)image.png

å› æ­¤ä¹Ÿå°±å¼•å…¥äº†ä¸€ä¸ª css-in-js è¢«è¯Ÿç—…å·²ä¹…çš„æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºå¼€å‘è€…åœ¨ä½¿ç”¨ css-in-js ç¼–å†™çš„æ ·å¼æœ¬èº«ä¸æ˜¯æœ€ç»ˆçš„ CSS æ ·å¼ï¼Œéœ€è¦åº”ç”¨åœ¨è¿è¡Œæ—¶è°ƒç”¨ css-in-js åº“å¯¹æ‰€å†™çš„ CSS æ ·å¼è¿›è¡Œåºåˆ—åŒ–ï¼Œç”Ÿæˆæœ€ç»ˆçš„å¯æ’å…¥é¡µé¢çš„ CSS æ ·å¼ï¼Œç„¶ååŸºäºæœ€ç»ˆçš„ CSS æ ·å¼å†å»ç”Ÿæˆå¯¹åº”çš„ hash å€¼ï¼Œè¿™æ ·ç»„ä»¶æ¯æ¬¡é‡æ–°æ¸²æŸ“å°±éœ€è¦é‡æ–°åºåˆ—åŒ–ä¸€æ¬¡ CSS æ ·å¼è¿›è€Œå¸¦æ¥é¢å¤–çš„å¼€é”€ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœ css-in-js æ ·å¼ä¼šè·Ÿéšç»„ä»¶çš„ props å˜åŒ–ï¼Œé‚£ä¹ˆè¿™ä¸ªæ€§èƒ½æ¶ˆè€—ä¾¿å˜å¾—ä¸å¯å¿½è§†ã€‚

å› æ­¤ï¼Œè¿™é‡Œæ€»ç»“ä¸€ä¸‹ä½¿ç”¨ css-in-js å‡ºç°æ€§èƒ½é—®é¢˜çš„ä¸¤ä¸ªæ ¹æœ¬åŸå› ï¼š

*   **ã€Œç»„ä»¶æœ¬èº«é¢‘ç¹çš„é‡æ¸²æŸ“ã€**ï¼ˆå¯ä»¥é€šè¿‡å°† CSS æ ·å¼æå–åˆ°ç»„ä»¶å¤–æˆ–è€…é€šè¿‡ç¼“å­˜æ¥è§£å†³ï¼‰ã€‚
    
*   **ã€Œcss-in-js æ ·å¼æœ¬èº«æ˜¯åŠ¨æ€çš„ï¼Œä¼šæ ¹æ®ç»„ä»¶ props å˜åŒ–ã€‚ã€**
    

å¦‚ä½•ç ´å±€
----

Antd ä¸ºäº†è§£å†³ **ã€Œcss-in-jsã€** å­˜åœ¨çš„æ€§èƒ½é—®é¢˜ï¼Œæ ¹æ®è‡ªèº«åœºæ™¯æ¨å‡ºäº†ä¸¤ä¸ªé‡è¦çš„ç›®æ ‡ï¼š

*   **ã€ŒAntd çš„ css-in-js æ ·å¼å¹¶ä¸è·Ÿéšç»„ä»¶æœ¬èº«çš„ props æ”¹å˜ã€**
    
    åœ¨ Antd ä¸­ï¼Œä¸€ä¸ªç»„ä»¶çš„æ ·å¼é€šå¸¸æ¥è¯´æ˜¯**ã€Œå®Œæ•´ã€**çš„ï¼Œåªè¦ä½¿ç”¨äº†æŸä¸ªç»„ä»¶ï¼Œantd å°±ä¼šè‡ªåŠ¨å¼•å…¥æœ‰å…³è¿™ä¸ªç»„ä»¶çš„æ‰€æœ‰æ ·å¼â€”â€”ä¸ç®¡æœ‰æ²¡æœ‰ä½¿ç”¨è¿‡ã€‚è¿™æ ·åšæœ‰ä¸¤ä¸ªåŸå› ï¼š
    

1.  Antd ä» 4.x åˆ° 5.x è¿›è¡Œæ”¹é€ æ—¶å¹¶æ²¡æœ‰æ”¹å˜æ ·å¼çš„ç»„ç»‡æ–¹å¼ï¼Œä»»ç„¶æ˜¯å’Œ 4.x ä¸€æ ·é€šè¿‡ class çš„ç»„åˆæ¥å®ç°ä¸åŒçš„æ ·å¼æ•ˆæœã€‚
    
2.  å‡å°‘åŠ¨æ€ç”Ÿæˆæ ·å¼çš„æ¬¡æ•°ã€‚Antd ä»¥ç»„ä»¶ä¸ºç»´åº¦åˆ¶å®šäº†ç¼“å­˜ç­–ç•¥ï¼ŒåŒä¸€ä¸ªç»„ä»¶åªä¼šæ’å…¥ä¸€æ¬¡æ ·å¼ï¼Œè¿™æ ·ä¼šå‡å°‘ css-in-js åœ¨åºåˆ—åŒ– CSS æ—¶çš„æ€§èƒ½æŸè€—ã€‚
    

*   **ã€Œå¯¹ç»„ä»¶åšæ ·å¼ç¼“å­˜ã€**![](https://mmbiz.qpic.cn/mmbiz_png/lCQLg02gtibtib3ShShaxtrCM8eELtkRe5YUAmJa479iabtlRDQ8e1OfzRbTddz4K5WV6Itn4JesGL4lBiceKabnEQ/640?wx_fmt=png&from=appmsg)
    
    å¯¹äºä¸€ä¸ª Antd ç»„ä»¶ï¼ŒAntd ä¼šé€šè¿‡ä¸Šé¢çš„ç­–ç•¥è®¡ç®—å½“å‰ç»„ä»¶æ ·å¼çš„ hash å€¼ï¼Œå‰è€…æ˜¯å½“å‰ç»„ä»¶çš„ tokenï¼Œå¯ä»¥é€šè¿‡ context è·å–ï¼Œåè€…æ˜¯å½“å‰ Antd çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä» package.json ä¸­è·å–ã€‚å› æ­¤åœ¨ hash ç›¸åŒçš„æƒ…å†µä¸‹ï¼ŒåŒä¸€ä¸ªç»„ä»¶æ— è®ºä½¿ç”¨äº†å¤šå°‘æ¬¡ã€æ¸²æŸ“äº†å¤šå°‘æ¬¡ï¼Œæ ·å¼æ°¸è¿œåªä¼šåœ¨ç¬¬ä¸€æ¬¡ mount æ—¶ç”Ÿæˆä¸€æ¬¡ï¼Œå‰©ä¸‹çš„æ—¶é—´é‡Œéƒ½ä¼šå‘½ä¸­ç¼“å­˜ ã€‚
    

Benchmark
---------

![](https://mmbiz.qpic.cn/mmbiz_png/lCQLg02gtibtib3ShShaxtrCM8eELtkRe5olC587lMfEnaiar7KREd7OmhliaBskHz1hMB59SItib0wcgOvMKqNO8aA/640?wx_fmt=png&from=appmsg)image.png

è¿™ä¸ª benchmark çš„æˆç«‹æ¡ä»¶æ˜¯äº§ç”Ÿä¸€æ®µéå¸¸é•¿çš„ä¸ä¼šå˜æ›´çš„æ ·å¼ï¼Œä»¥æ­¤æ¥æµ‹è¯•è¿™ä¸‰ä¸ªåº“çš„åŸºæœ¬ç”¨æ³•çš„æ€§èƒ½ã€‚å¯ä»¥çœ‹å‡ºåœ¨ Ant Design çš„ â€œç»„ä»¶çº§â€ ä½¿ç”¨åœºæ™¯ä¸‹ï¼Œæ— è®ºæ˜¯åˆæ¬¡æ¸²æŸ“è¿˜æ˜¯äºŒæ¬¡æ¸²æŸ“ï¼ŒAntd éƒ½æ‹¥æœ‰æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ã€‚ç”±äº styled åœ¨å¤„ç†ç¨³å®šçš„æ ·å¼æ—¶æœ‰ä¸€å®šä¼˜åŒ–ï¼Œæ‰€ä»¥è¿™ä¸ª benchmark ä¸­äºŒæ¬¡æ¸²æŸ“çš„æ€§èƒ½è¾ƒå¥½ï¼Œä½†åœ¨æœ‰ props å‚ä¸æ ·å¼è®¡ç®—æ—¶ä»ä¼šå’Œ emotion ä¸€æ ·å—åˆ°é‡æ–°è®¡ç®—çš„å½±å“ã€‚

å°ç»“
--

Antd é’ˆå¯¹ css-in-js åœ¨æ€§èƒ½ä¸Šçš„é—®é¢˜ï¼Œç»“åˆè‡ªèº«çš„åœºæ™¯ç»™å‡ºäº†ç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ¡ˆï¼ŒAntd è·å¾—äº†ç›¸è¾ƒäºå…¶ä»– css-in-js åº“æ›´é«˜çš„æ€§èƒ½ï¼Œä½†ä»£ä»·åˆ™æ˜¯ç‰ºç‰²äº†å…¶åœ¨åº”ç”¨ä¸­è‡ªç”±ä½¿ç”¨çš„çµæ´»æ€§ã€‚æ‰€ä»¥è¿™ä¸ªæ–¹æ¡ˆä¹Ÿè¢«ç§°ä¸º â€œç»„ä»¶çº§â€ çš„ css-in-js æ–¹æ¡ˆã€‚

> â
> 
> ğŸ’¡ @ant-design/cssinjs æ˜¯å®ç° antd ç»„ä»¶åº“çš„ä¸€å¥—ç»„ä»¶çº§çš„ css-in-js æ–¹æ¡ˆï¼Œå®ƒé€šè¿‡æ¯”è¾ƒç¹ççš„å†™æ³•æ¢å¾—äº†ç›¸æ¯” styled-component å’Œ emotion éƒ½è¦å¥½å¾ˆå¤šçš„æ€§èƒ½ã€‚
> 
> â

CSS æ ·å¼è¦†ç›–æ–¹æ¡ˆé€‰æ‹©
============

Antd ä½œä¸ºä¸€ä¸ªç»„ä»¶åº“ï¼Œä»–çš„èŒè´£åªåœ¨äºæä¾›é«˜å“è´¨çš„åŸºç¡€ç»„ä»¶ï¼Œå› æ­¤åº”ç”¨å±‚å¦‚ä½•ä½¿ç”¨æ ·å¼æ–¹æ¡ˆï¼ŒAntd å¹¶ä¸å…³å¿ƒä¹Ÿä¸åšé™åˆ¶ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨ lessã€sassã€styled-componentsã€tailwindcssã€emotion ç­‰æ–¹æ¡ˆå¯¹ Antd ç»„ä»¶è¿›è¡Œæ ·å¼è¦†ç›–ã€‚

æ ·å¼è¦†ç›–æ–¹æ¡ˆ
------

æ ·å¼è¦†ç›–æ–¹æ¡ˆå¤§ç±»å¯åˆ†ä¸ºä¸¤ç±»ï¼šcss-module å’Œ css-in-jsã€‚

> â
> 
> å…¨å±€æ ·å¼è¦†ç›–æš‚æ—¶ä¸è€ƒè™‘ï¼Œè¿™ç§æ–¹æ¡ˆä¸å¯æ§ä¸”ç»´æŠ¤éå¸¸å›°éš¾ã€‚
> 
> â

ç›®æ ‡
--

*   é«˜æ€§èƒ½ï¼ˆcss-module ä¼˜äº css-in-jsï¼‰
    
    css-module ç›¸æ¯”äº css-in-js æœ‰ç€å¤©ç„¶çš„æ€§èƒ½ä¼˜åŠ¿ï¼Œå› ä¸ºå®ƒæ˜¯ç¼–è¯‘æ—¶ï¼Œä¸éœ€è¦åœ¨åº”ç”¨è¿è¡Œæ—¶å»åºåˆ—åŒ–æ ·å¼ã€‚
    
*   é«˜å¯æ‰©å±•ï¼ˆcss-in-js ä¼˜äº css-module ï¼‰
    
    åœ¨æ‰©å±•æ–¹é¢ï¼Œcss-in-js å æ®ç€ç»å¯¹çš„ä¼˜åŠ¿ï¼Œå› ä¸ºè¿è¡Œæ—¶èµ‹äºˆäº†å®ƒæ›´é«˜çš„çµæ´»æ€§ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ Antd ä¸­å¼€å‘è€…å¯ä»¥é€šè¿‡ ConfigProvider çš„Â `prefixCls`Â ä¿®æ”¹ç»„ä»¶ className çš„å‰ç¼€ï¼Œè¿™ç§åœºæ™¯æ˜¯å¾ˆå¸¸è§çš„ï¼Œå¯¹äº css-module æ¥è¯´è¿™æ˜¯éå¸¸éš¾å®ç°çš„ï¼Œæ›´åˆ«è¯´åµŒå¥— ConfigProvider çš„åœºæ™¯ã€‚
    
    è€Œåœ¨ css-in-js ä¸­ï¼Œæ··åˆÂ `prefixCls`Â æ˜¯å¾ˆå®¹æ˜“çš„äº‹æƒ…ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ ConfigProvider çš„Â `getPrefixCls`Â æ–¹æ³•æ¥è·å–Â `prefixCls`ï¼Œç„¶åè¿›è¡Œæ··åˆï¼š
    
    ```
    import React from 'react';
    import {ConfigProvider} from 'antd';
    import {createStyles} from 'antd-style';
    
    const useButtonStyle = () => {
      const {getPrefixCls} = React.useContext(ConfigProvider.ConfigContext);
      const btnPrefixCls = getPrefixCls('btn');
    
      return createStyles(({ css }) => ({
        btn: css`
          background: red;
          .${btnPrefixCls}-icon {
            color: green;
          }
        `,
      }))();
    };
    
    function GeekProvider(props: {children?: React.ReactNode}) {
      const {styles} = useButtonStyle();
    
      return <ConfigProvider button={{className: styles.btn}}>{props.children}</ConfigProvider>;
    }
    ```
    
*   å…¼å®¹æ€§å¼º
    
    èƒ½å¤Ÿå…¼å®¹ SSR ã€å¾®å‰ç«¯ç­‰åœºæ™¯ã€‚
    

æ€»ä½“æ¥è¯´ä¸ç®¡æ˜¯ css-module è¿˜æ˜¯æ¯”è¾ƒæµè¡Œçš„ css-in-js æ–¹æ¡ˆï¼Œéƒ½ä¸èƒ½å®Œå…¨æ»¡è¶³**ã€Œç›®æ ‡ã€**ï¼Œé¢å¯¹å¼€å‘è€…çš„è¯‰æ±‚ï¼Œå®˜æ–¹ç»™å‡ºäº†ä»–ä»¬çš„è§£å†³æ–¹æ¡ˆâ€”â€”antd-styleã€‚

å®˜æ–¹å‡ºæ‰‹â€”antd-style
---------------

### èƒŒæ™¯

ä¸Šé¢ä»‹ç»è¿‡ï¼Œantd ç»„ä»¶åº“æœ¬èº«çš„æ ·å¼æ˜¯åŸºäº css-in-js å®ç°çš„ï¼Œä¸ºäº†åœ¨ä½¿ç”¨ css-in-js å¸¦æ¥çš„çµæ´»æ€§çš„åŒæ—¶ä¹Ÿèƒ½æ‹¥æœ‰ç›¸æ¯” styled-component å’Œ emotion æ›´å¥½çš„æ€§èƒ½ï¼Œantd æ¨å‡ºäº†**ã€Œç»„ä»¶çº§åˆ«çš„ css-in-js æ–¹æ¡ˆã€**ï¼ˆ@ant-design/cssinjsï¼‰ï¼Œä½†å¯¹åº”ç”¨å’ŒåŸºäº antd å°è£…çš„ç»„ä»¶åº“ä¸­ï¼Œè¿™ç§å†™æ³•å¯èƒ½è¿‡äºç¹çå’Œå¤æ‚ï¼Œä¸”ç¼ºå°‘æ¶ˆè´¹ antd token ç³»ç»Ÿçš„èƒ½åŠ›ã€‚

### antd-style æ˜¯ä»€ä¹ˆï¼Ÿ

`antd-style`Â æ˜¯åŸºäº Ant Design V5 Token System æ„å»ºçš„ä¸šåŠ¡çº§ css-in-js è§£å†³æ–¹æ¡ˆï¼Œå®ƒçš„é€‚ç”¨åœºæ™¯æ˜¯ä¸šåŠ¡åº”ç”¨å’ŒåŸºäº antd äºŒæ¬¡å°è£…çš„ç»„ä»¶åº“ï¼Œå®ƒä¼šæä¾›è¿™ä¸¤ä¸ªåœºæ™¯æ‰€éœ€è¦çš„æ‰€æœ‰èƒ½åŠ›ã€‚

### ä½¿ç”¨æ–¹å¼

*   å®‰è£… antd-style
    
    ```
    yarn add antd-style 
    æˆ–
    npm install antd-style
    ```
    
*   è¦†ç›–ç»„ä»¶æ ·å¼ï¼ˆå®˜æ–¹æ¨èæ ·å¼è¦†ç›–çš„æ–¹å¼ï¼‰
    
    ```
    import React from 'react';
    import {ConfigProvider} from 'antd';
    import {createStyles} from 'antd-style';
    
    const useButtonStyle = () => {
      const {getPrefixCls} = React.useContext(ConfigProvider.ConfigContext);
      const btnPrefixCls = getPrefixCls('btn');
    
      return createStyles(({css, token}) => ({
        btn: css`
          background: red;
          .${btnPrefixCls}-icon {
            color: green;
          };
    			background: ${token.colorPrimary};
        `,
      }))();
    };
    
    function GeekProvider(props: {children?: React.ReactNode}) {
      const {styles} = useButtonStyle();
    
      return <ConfigProvider button={{className: styles.btn}}>{props.children}</ConfigProvider>;
    }
    ```
    
    æ›´å¤šä½¿ç”¨æ–¹å¼å¯æŸ¥çœ‹å®˜ç½‘ã€‚
    

### æ˜¯å¦èƒ½å¤Ÿæ»¡è¶³ç›®æ ‡ï¼Ÿ

*   **ã€Œé«˜æ€§èƒ½ã€** âœ…
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/lCQLg02gtibtib3ShShaxtrCM8eELtkRe5PjkPwlyvcYMabqnNFHUtGOTKFrH5mWaBmVDiaPibqDgNo4wQIDOlGL6g/640?wx_fmt=png&from=appmsg)image.png
    
    antd-style çš„ç›®æ ‡ä¹‹ä¸€å°±æ˜¯ä¸ºç»„ä»¶å¼€å‘è€…å¼€å‘çš„ç»„ä»¶èƒ½å¤Ÿè·å¾—æ›´ä¼˜çš„æ€§èƒ½ï¼ŒAntd å®˜æ–¹ä¹Ÿé’ˆå¯¹ antd-style çš„æ€§èƒ½ä¸å…¶ä»– CSS-in-JS åº“è¿›è¡Œäº†å¯¹æ¯”ï¼Œå¯æŸ¥çœ‹ benchmarkã€‚
    
*   **ã€Œé«˜å¯æ‰©å±•ã€** âœ…
    
    antd-style æœ¬èº«æ˜¯ä¸€ä¸ª css-in-js æ–¹æ¡ˆï¼Œå› æ­¤å¤©ç”Ÿåœ¨çµæ´»æ€§ä¸Šæœ‰å¾ˆå¤§çš„ä¼˜åŠ¿ï¼ŒåŒæ—¶å®ƒè¿˜æ”¯æŒè‡ªå®šä¹‰ tokenã€å¤åˆæ ·å¼ï¼ˆstylishï¼‰ç­‰èƒ½åŠ›ã€‚
    
*   **ã€Œå…¼å®¹æ€§å¼ºã€** âœ…
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/lCQLg02gtibtib3ShShaxtrCM8eELtkRe5V9KoWl6zncBvBT88dvQHQcEWP0KO2XVErUTziaeNtODDsQVsMSD4mWQ/640?wx_fmt=png&from=appmsg)antd-style å·²ç»æ”¯æŒ SSRï¼ŒåŒæ—¶å¾®å‰ç«¯åœºæ™¯ä¹Ÿåœ¨æœªæ¥çš„ feature ä¸­ã€‚
    

### è¯¯åŒº

1.  **ã€Œantd-style å½»åº•è§£å†³äº†æ€§èƒ½é—®é¢˜å—ï¼Ÿã€**
    
    æ²¡æœ‰ï¼Œantd-style çš„æ€§èƒ½è¿˜è¾¾ä¸åˆ° @ant-design/cssinjs Â çš„æ°´å¹³ï¼ŒåŸå› æ˜¯ @ant-design/cssinjs åŒ…åœ¨ä¸æ”¯æŒå“åº” props çš„è®¾å®šä¸‹å¯ä»¥é™æ€åŒ–ï¼Œä¸éœ€è¦é¢‘ç¹çš„åºåˆ—åŒ–ï¼Œè¿›è€Œæå‡æ€§èƒ½ï¼Œä½†ä¸šåŠ¡åº”ç”¨ä¸­éœ€è¦ä½¿ç”¨ props æ¥åŠ¨æ€å“åº”æ ·å¼ã€‚
    

### ç»“è®º

ç›¸æ¯”äº lessã€sassã€styles-componentã€emotion ç­‰æ ·å¼è¦†ç›–æ–¹æ¡ˆï¼Œantd-style ä½œä¸ºå®˜æ–¹æä¾›çš„ css-in-js æ–¹æ¡ˆï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„æ»¡è¶³åŸºäº antd äºŒæ¬¡å°è£…çš„ç»„ä»¶åº“è¿™ä¸ªåœºæ™¯æ‰€éœ€è¦çš„èƒ½åŠ›ï¼Œåœ¨æ€§èƒ½ã€æ‰©å±•æ€§å’Œå…¼å®¹æ€§ä¸Šéƒ½å˜æ˜¾å¾—éå¸¸ä¼˜å¼‚ï¼Œä½†æ˜¯ç›®å‰è¿™ä¸ªåº“è¿˜å¤„äºæŒç»­å»ºè®¾é˜¶æ®µï¼Œéƒ¨åˆ†æ–‡æ¡£å’ŒåŠŸèƒ½å»ºè®¾è¿˜ä¸å®Œå–„ï¼Œæœ‰ä¸€å®šçš„ä¸Šæ‰‹éš¾åº¦ã€‚