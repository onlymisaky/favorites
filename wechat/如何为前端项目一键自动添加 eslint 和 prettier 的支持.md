> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/iwrhNAMp_lJpSrOFUGWrLg)

æœ¬æ–‡å±äºæºç å…±è¯»ç¬¬ 35 æœŸ | ä¸º vite é¡¹ç›®è‡ªåŠ¨æ·»åŠ  eslint å’Œ prettier ç‚¹å‡»äº†è§£æœ¬æœŸè¯¦æƒ…ä¸€èµ·å‚ä¸Â https://juejin.cn/post/7113563466211786783

> å‰è¨€

æˆ‘ä¹‹å‰å¥½å¤šæ¬¡éƒ½æ˜¯ä¸€æ­¥ä¸€æ­¥çš„å®‰è£… eslint å’Œ prettier åŠç›¸å…³ä¾èµ–ï¼Œä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸€ä¸ªé…ç½®æ–‡ä»¶çš„ç²˜è´´å¤åˆ¶ï¼Œå¹¶ä¿®æ”¹å…¶ä¸­çš„ç›¸å…³é…ç½®ã€‚è€Œä¸”å¯èƒ½ä¼šåœ¨æ¯ä¸ªé¡¹ç›®ä¸­éƒ½è¦å»å¤„ç†ï¼Œå¦‚æœé¡¹ç›®å·¥ç¨‹è§„åˆ’åŒ–ä»¥åï¼Œeslint å’Œ prettier ç¡®å®æ˜¯é¡¹ç›®å°‘ä¸äº†çš„é…ç½®ã€‚ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰åƒæˆ‘ä¸€æ ·æ“ä½œè¿‡å‘¢ï¼Ÿ

é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹å¼å»å¤„ç†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æˆ‘ç»ˆäºé‡åˆ°äº†ã€‚é€šè¿‡è‹¥å·å¤§ä½¬çš„[æºç å…±è¯»æ´»åŠ¨](https://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650763595&idx=1&sn=14878a71ff9815a4e6fabf927c27f71a&chksm=886672c7bf11fbd1379e1fd9ab4c095ca1e169dff446cedf5f85b5fbedd567d596cf9aec6eae&token=1016586406&lang=zh_CN&scene=21#wechat_redirect)å‘ç°äº†ï¼ŒçœŸçš„æ˜¯å¤ªæ£’äº†ã€‚

æœ¬æ–‡ä»¥`viteè„šæ‰‹æ¶`åˆ›å»ºçš„é¡¹ç›®ä¸ºåŸºç¡€è¿›è¡Œç ”ç©¶çš„ï¼Œå¦‚æœæ˜¯å…¶ä»–è„šæ‰‹æ¶åˆ›å»ºçš„é¡¹ç›®ï¼Œé‚£ä¹ˆå°±è¦è‡ªå·±å»ä¿®æ”¹å¤„ç†ï¼Œä½†æ˜¯åŸç†æ˜¯ä¸€æ ·çš„ã€‚

é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘å°±è¦æ¥ä¸€æ¢ç©¶ç«Ÿï¼Œå…ˆçœ‹çœ‹å¦‚ä½•ä½¿ç”¨ï¼Œç„¶åæŸ¥é˜…ä¸€ä¸‹å®ƒçš„æºç ï¼Œçœ‹çœ‹å®ƒåˆ°åº•æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ

1ã€vite åˆ›å»ºé¡¹ç›®
-----------

*   åˆ›å»ºé¡¹ç›®
    

```
yarnÂ createÂ vite
```

ä¸€é¡¿æ“ä½œä»¥åé¡¹ç›®å°±åˆ›å»ºå®Œæ¯•äº†

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJoJeOw4Lkz9wkMg1LOYQry7n0ibVx0CFJ1mjibZatpATnbUsGjez7ScAgQ/640?wx_fmt=png)image.png

*   2ã€å®‰è£…ä¾èµ–
    

```
yarn
```

*   3ã€è¿è¡Œé¡¹ç›®
    

```
yarnÂ dev
```

*   4ã€è¿è¡Œåˆå§‹åŒ– eslint å’Œ prettier å‘½ä»¤
    

```
yarnÂ createÂ vite-pretty-lint
```

å…ˆæ¥çœ‹æ²¡æœ‰æ‰§è¡Œå‘½ä»¤å‰çš„æ–‡ä»¶ç›®å½•

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJo5eR81glKZEhzPrzaehgC0Bgr1kLtGbV2iceI2owloFIwMmicMCpqEYPQ/640?wx_fmt=png)image.png

å†æ¥çœ‹æ‰§è¡Œå®Œå‘½ä»¤åçš„æ–‡ä»¶ç›®å½•

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJorKiaORWPDYTiaCajniam13FXT2f0Gd5pdU7vrBx9HXbfDQngiaXialZKWZQ/640?wx_fmt=png)image.png

å¯ä»¥å‘ç°æ–‡ä»¶ç›®å½•ä¸­å¢åŠ äº† eslint å’Œ prettier çš„ç›¸å…³é…ç½®ï¼Œpackage.json ä¸­å¢åŠ äº†ç›¸å…³çš„ä¾èµ–ã€ä»¥åŠ vite.config.xx æ–‡ä»¶ä¹Ÿå¢åŠ äº†ç›¸å…³é…ç½®ï¼Œå…·ä½“çš„æ–‡ä»¶å˜æ›´å¯ä»¥æŸ¥çœ‹ https://github.com/lxchuan12/vite-project/commit/6cb274fded66634191532b2460dbde7e29836d2eã€‚

ä¸€ä¸ªå‘½ä»¤å¹²äº†è¿™ä¹ˆå¤šäº‹æƒ…ï¼ŒçœŸçš„å¤ªä¼˜ç§€äº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±å»çœ‹çœ‹è¿™å¦‚æ­¤ä¼˜ç§€çš„æºä»£ç å§

2ã€æ•´ä¸ªè¿‡ç¨‹çš„ç¤ºæ„å›¾
----------

é€šè¿‡å¤§è‡´çš„æŸ¥çœ‹æºä»£ç ï¼Œç®€å•æ€»ç»“å‡ºæ¥çš„ä»£ç æ‰§è¡Œè¿‡ç¨‹ç¤ºæ„å›¾ï¼Œä»…ä¾›å‚è€ƒ

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJoon3Udicgr2aCuF3Nwwe91PwmuQ4E4Bo8KolKZguZKxaG1eUWhNIkgpQ/640?wx_fmt=png)æœªå‘½åæ–‡ä»¶ (3).png

3ã€æºç è°ƒè¯•è¿‡ç¨‹
--------

### 3.1ã€æ‰¾åˆ°è°ƒè¯•ä»£ç çš„ä½ç½®

é€šè¿‡`package.json`ä¸­çš„ bin èŠ‚ç‚¹å¯ä»¥å‘ç°ï¼Œ`yarn create vite-pretty-lint`æœ€ç»ˆæ‰§è¡Œçš„ä¾¿æ˜¯ lib/main.js ä¸­çš„ä»£ç 

```
"bin":Â {Â Â Â Â "create-vite-pretty-lint":Â "lib/main.js"Â Â },
```

### 3.2ã€ å¼€å§‹è°ƒè¯•çš„å‘½ä»¤

å› ä¸ºæˆ‘ä»¬ç°åœ¨åªæ˜¯è¦æ‰§è¡Œ`lib/main.js`è¿™ä¸ªå…¥å£æ–‡ä»¶ï¼Œé€šè¿‡`package.json`çš„`scripts` ä¹Ÿæ²¡æœ‰å‘ç°æ‰§è¡Œå‘½ä»¤ï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡`node`æ¥è¿è¡Œä»£ç 

```
nodeÂ lib/main.js
```

è°ƒè¯•æˆåŠŸçš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJoN60VoFyC6wTjjn2vLx8UjDkkg0IU763ia7ypiaiaarTgAHiaydjPvBpqMw/640?wx_fmt=png)ä¼ä¸šå¾®ä¿¡æˆªå›¾_16564645675849.png

### 3.3ã€ æŸ¥çœ‹å¤´éƒ¨å¼•å…¥çš„æ¨¡å—

*   chalk ç»ˆç«¯å¤šè‰²å½©è¾“å‡º
    

```
npmÂ iÂ chalkimportÂ chalkÂ fromÂ 'chalk'constÂ logÂ =Â console.log//Â å­—ä½“èƒŒæ™¯é¢œè‰²è®¾ç½®log(chalk.bgGreen('chalkæ‰“å°è®¾ç½®')Â )//Â å­—ä½“é¢œè‰²è®¾ç½®log(chalk.blue('Hello')Â +Â 'Â World'Â +Â chalk.red('!'))//Â è‡ªå®šä¹‰é¢œè‰²constÂ customÂ =Â chalk.hex('#F03A17')constÂ bgCustomÂ =Â chalk.bgHex('#FFFFFF')log(custom('customer'))log(bgCustom('bgCustom'))
```

æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJoge7ahX6sxa32A6xo4AaxPas22jUAduaKNtrxyNtlo16RicwAvA8NtyQ/640?wx_fmt=png)image.png

*   gradient æ–‡å­—é¢œè‰²æ¸å˜
    

```
//Â å®‰è£…npmÂ iÂ gradient-string//Â å¼•å…¥importÂ gradientÂ Â fromÂ 'gradient-string'//Â ä½¿ç”¨console.log(gradient('cyan',Â 'pink')('ä½ å¥½å•Šèµ›åˆ©äºšæ¬¢è¿æ¥åˆ°ç¼–ç ä¸–ç•Œ'));console.log(gradient('cyan',Â 'pink')('ä½ å¥½å•Šèµ›åˆ©äºšæ¬¢è¿æ¥åˆ°ç¼–ç ä¸–ç•Œ'));console.log(gradient('cyan',Â 'pink')('ä½ å¥½å•Šèµ›åˆ©äºšæ¬¢è¿æ¥åˆ°ç¼–ç ä¸–ç•Œ'));console.log(gradient('cyan',Â 'pink')('ä½ å¥½å•Šèµ›åˆ©äºšæ¬¢è¿æ¥åˆ°ç¼–ç ä¸–ç•Œ'));console.log(gradient('cyan',Â 'pink')('ä½ å¥½å•Šèµ›åˆ©äºšæ¬¢è¿æ¥åˆ°ç¼–ç ä¸–ç•Œ'));
```

æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJotF5LNPHt9XEec0GyOl7VWaqaNsOiaV9sbjTmWAFEvoIsYWGtFicVOFYA/640?wx_fmt=png)image.png

*   child_process node.js ä¸­çš„å­è¿›ç¨‹ã€‚
    
    > åœ¨ node.js ä¸­ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ‰€æœ‰çš„æ“ä½œï¼Œå¦‚æœæŸä¸ªæ“ä½œéœ€è¦å¤§é‡æ¶ˆè€— CPU èµ„æºçš„è¯ï¼Œåç»­çš„æ“ä½œå°±éœ€è¦ç­‰å¾…ã€‚åæ¥ node.js å°±æä¾›äº†ä¸€ä¸ª`child_process`æ¨¡å—ï¼Œé€šè¿‡å®ƒå¯ä»¥å¼€å¯å¤šä¸ªå­è¿›ç¨‹ï¼Œåœ¨å¤šä¸ªå­è¿›ç¨‹ä¹‹é—´å¯ä»¥å…±äº«å†…å­˜ç©ºé—´ï¼Œå¯ä»¥é€šè¿‡å­è¿›ç¨‹çš„äº’ç›¸é€šä¿¡æ¥å®ç°ä¿¡æ¯çš„äº¤æ¢ã€‚
    

```
importÂ {Â execÂ }Â fromÂ 'child_process';exec('ls',(error,Â stdout,stderr)=>Â {Â Â Â Â if(error)Â {Â Â Â Â Â Â Â Â console.log(error)Â Â Â Â Â Â Â Â return;Â Â Â Â }Â Â Â Â console.log('stdout:Â 'Â +Â stdout)Â Â Â Â console.log('æ‰§è¡Œå…¶ä»–æ“ä½œ')})
```

æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJoXuXDPpYwibD8uPFViamJE1fcanaickyjSedsIziakMgf7Z7hnkI8n6G96A/640?wx_fmt=png)image.png

*   fs fs ç”¨æ¥æ“ä½œæ–‡ä»¶çš„æ¨¡å—
    

```
importÂ fsÂ fromÂ 'fs'//Â åŒæ­¥çš„è¯»å–æ–¹æ³•ï¼Œç”¨æ¥è¯»å–æŒ‡å®šæ–‡ä»¶ä¸­çš„å†…å®¹fs.readFileSync()Â //Â åŒæ­¥çš„å†™å…¥æ–¹æ³•ï¼Œç”¨æ¥å‘æŒ‡å®šæ–‡ä»¶ä¸­å†™å†…å®¹fs.writeFileSync()
```

*   path è·¯å¾„åˆ†ç±»
    

```
importÂ pathÂ fromÂ 'path';//Â æ‹¼æ¥è·¯å¾„console.log(path.join('src',Â 'task.js'));Â Â //Â src/task.js
```

*   nanospinner å‘½ä»¤è¡Œä¸­çš„åŠ è½½åŠ¨ç”»
    

```
//Â å®‰è£…npmÂ iÂ nanospinner//Â å¼•å…¥æ¨¡å—importÂ {Â createSpinnerÂ }Â fromÂ 'nanospinner';constÂ spinnerÂ =Â createSpinner('RunÂ test').start()setTimeout(()Â =>Â {Â Â spinner.success()},Â 1000)
```

æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆRun test åœ¨åŠ è½½çš„ä¸€ä¸ªæ•ˆæœï¼‰

![](https://mmbiz.qpic.cn/mmbiz_gif/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJocJeaMaiaiaaKqBaKzICTj3gicVMgCeFGwdtljdq8ucXjrDjS2WBuGlWCw/640?wx_fmt=gif)3.gif

*   enquirer (utils.js æ–‡ä»¶)
    

äº¤äº’å¼è¯¢é—® CLI ç®€å•è¯´å°±æ˜¯äº¤äº’å¼è¯¢é—®ç”¨æˆ·è¾“å…¥

```
npmÂ iÂ enquirerÂ importÂ enquirerÂ fromÂ 'enquirer'Â letÂ tempArrayÂ =Â ['major(1.0.0)','minor(0.1.0)',Â 'patch(0.0.4)',Â "customer"Â ]constÂ {Â releaseÂ }Â =Â awaitÂ enquirer.prompt({Â Â Â Â type:Â 'select',Â Â Â Â name:Â 'release',Â Â Â Â message:Â 'SelectÂ releaseÂ type',Â Â Â Â choices:Â tempArray})if(releaseÂ ===Â 'customer')Â {Â Â Â Â console.log(release,Â 'customer')}Â elseÂ {Â Â Â Â constÂ targetVersionÂ =Â release.match(/\((.*)\)/)[1]Â Â Â Â console.log(targetVersion,Â 'targetVersion')}
```

æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå…ˆå‡ºæ¥ä¸€ä¸ªä¸‹æ‹‰é€‰æ‹©ï¼Œé€‰æ‹©å®Œåæ ¹æ® if åˆ¤æ–­è¿›è¡Œè¾“å‡º

![](https://mmbiz.qpic.cn/mmbiz_gif/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJoLE7TzpvM9vy8DpvUck0L7yWODyRgVwfKBDcukf2u0P2sBFzibF69Beg/640?wx_fmt=gif)4.gif

### 3.4ã€ è°ƒè¯•å…·ä½“ä»£ç 

##### 3.4.1ã€ main.js ä¸­çš„å…¥å£

```
asyncÂ functionÂ run()Â {Â Â Â Â //Â æ‰€æœ‰çš„é€»è¾‘ä»£ç }run().catch((e)Â =>Â {Â Â console.error(e);});
```

é€šè¿‡`run`å‡½æ•°å°è£…å¼‚æ­¥æ–¹æ³•ï¼Œè¿™æ ·æœ€å¤–é¢è°ƒç”¨`run`å‡½æ•°æ—¶å¯ä»¥é€šè¿‡å¼‚æ­¥æ–¹æ³•çš„`catch`æ•è·é”™è¯¯å¼‚å¸¸ã€‚

çœ‹ä¸€ä¸ªå°ä¾‹å­

```
constÂ runTestÂ =Â asyncÂ ()Â =>Â {Â Â Â Â console.log('RunningÂ test')Â Â Â Â throwÂ newÂ Error('runÂ testæŠ¥é”™äº†')}Â runTest().catch(errÂ =>Â {Â Â Â Â console.log('Error:Â 'Â +Â err)})
```

æ‰§è¡Œåæ‰“å°é¡ºåºå¦‚ä¸‹

```
RunningÂ testError:Â Error:Â runÂ testæŠ¥é”™äº†
```

å¯ä»¥å‘ç° catch ä¸­æˆªè·äº†å¼‚å¸¸

> æ¥ä¸‹æ¥å¼€å§‹è¿›å…¥ run å‡½æ•°äº†

##### 3.4.2ã€ æ‰“å°è‰²å½©å­—ä½“

```
//Â è¿™ä¸ªçœ‹ä¸Šé¢çš„å¼•å…¥æ¨¡å—è§£æå³å¯console.log(Â Â Â Â chalk.bold(Â Â Â Â Â Â gradient.morning('\nğŸš€Â WelcomeÂ toÂ EslintÂ &Â PrettierÂ SetupÂ forÂ Vite!\n')Â Â Â Â ));
```

##### 3.4.3ã€ äº¤äº’å¼å‘½ä»¤è¡Œ

```
exportÂ functionÂ getOptions()Â {Â Â constÂ OPTIONSÂ =Â [];Â Â fs.readdirSync(path.join(__dirname,Â 'templates')).forEach((template)Â =>Â {Â Â Â Â constÂ {Â nameÂ }Â =Â path.parse(path.join(__dirname,Â 'templates',Â template));Â Â Â Â OPTIONS.push(name);Â Â });Â Â returnÂ OPTIONS;}exportÂ functionÂ askForProjectType()Â {Â Â returnÂ enquirer.prompt([Â Â Â Â {Â Â Â Â Â Â type:Â 'select',Â Â Â Â Â Â name:Â 'projectType',Â Â Â Â Â Â message:Â 'WhatÂ typeÂ ofÂ projectÂ doÂ youÂ have?',Â Â Â Â Â Â choices:Â getOptions(),Â Â Â Â },Â Â Â Â {Â Â Â Â Â Â type:Â 'select',Â Â Â Â Â Â name:Â 'packageManager',Â Â Â Â Â Â message:Â 'WhatÂ packageÂ managerÂ doÂ youÂ use?',Â Â Â Â Â Â choices:Â ['npm',Â 'yarn'],Â Â Â Â },Â Â ]);}Â Â tryÂ {Â Â Â Â constÂ answersÂ =Â awaitÂ askForProjectType();Â Â Â Â projectTypeÂ =Â answers.projectType;Â Â Â Â packageManagerÂ =Â answers.packageManager;Â Â }Â catchÂ (error)Â {Â Â Â Â console.log(chalk.blue('\nğŸ‘‹Â Goodbye!'));Â Â Â Â return;Â Â }
```

`getOptions` å‡½æ•°æ ¹æ®`fs.readdirSync`è¯»å–é¡¹ç›®å·¥ç¨‹`template`æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶é€šè¿‡`path.parse`è½¬æ¢å¯¹è±¡ï¼Œæ¥è·å–æ–‡ä»¶åç§°`name`ã€‚

`askForProjectType`å‡½æ•°é€šè¿‡`enquirer.prompt`è¿”å›ä¸¤ä¸ªäº¤äº’å¼å‘½ä»¤è¡Œï¼Œä¾›ç”¨æˆ·è¿›è¡Œé€‰æ‹©`projectType`é€‰æ‹©é¡¹ç›®ç±»å‹ï¼šã€react-tsã€‘ ã€reactã€‘ã€vue-tsã€‘ ã€vueã€‘`packageManager`é€‰æ‹©é¡¹ç›®åŒ…ç®¡ç†æ–¹å¼ï¼šã€npmã€‘ ã€yarnã€‘

##### 3.4.4ã€æ ¹æ®äº¤äº’å‘½ä»¤è¡Œè¿”å›ç»“æœè¿›è¡ŒåŒ¹é…æ¨¡æ¿

å‡å¦‚æˆ‘ä»¬ä¸Šé¢é€‰æ‹©çš„æ˜¯`[vue-ts]`

```
constÂ {Â packages,Â eslintOverridesÂ }Â =Â awaitÂ import(Â Â Â Â `./templates/${projectType}.js`);
```

`/template/vue-ts.js`æ¨¡æ¿ä¸­çš„ä»£ç  (å…¶ä¸­ä»£ç è¾ƒå¤šä½†ä¸€çœ‹å°±æ˜ç™½æˆ‘å°±ä¸è´´äº†), å°±æ˜¯`export`å¯¼å‡ºäº†ä¸¤ä¸ªå›ºå®šçš„æ¨¡æ¿å˜é‡æ•°ç»„ï¼Œ`packages`åˆ™ç›¸å½“äºè¦å¼•å…¥çš„ npm æ¨¡å—åˆ—è¡¨ï¼ŒeslintOverrides è¿™ç®—æ˜¯`.eslintrc.json`åˆå§‹åŒ–æ¨¡æ¿ã€‚

##### 3.4.5ã€æ‹¼æ¥å˜é‡æ•°ç»„

```
constÂ packageListÂ =Â [...commonPackages,Â ...packages];constÂ eslintConfigOverridesÂ =Â [...eslintConfig.overrides,Â ...eslintOverrides];constÂ eslintÂ =Â {Â ...eslintConfig,Â overrides:Â eslintConfigOverridesÂ };
```

`commonPackages`æ˜¯`shared.js`ä¸­é¢„å®šä¹‰çš„å…¬å…±çš„ npm æ¨¡å—`eslint`åˆ™æ˜¯é€šè¿‡å…¬å…± npm æ¨¡å—ä¸­çš„`eslintConfig`å’Œä¸Šé¢é€‰æ‹©çš„`template/xxxx.js`ä¸­çš„è¿›è¡Œæ‹¼æ¥ç»„æˆã€‚

##### 3.4.6ã€ ç”Ÿæˆå®‰è£…ä¾èµ–åŒ…çš„å‘½ä»¤

```
constÂ commandMapÂ =Â {Â Â Â Â npm:Â `npmÂ installÂ --save-devÂ ${packageList.join('Â ')}`,Â Â Â Â yarn:Â `yarnÂ addÂ --devÂ ${packageList.join('Â ')}`,};
```

å°†`packageList`æ•°ç»„é€šè¿‡ join è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œé€šè¿‡å‘½ä»¤å°†æ‰€æœ‰æ‹¼æ¥ npm æ¨¡å—ä¸€èµ·å®‰è£…

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJoxQqIR43A3xlsJ28vUsmrCjpciaOibAL23M5tBTBtKXa8gDRCQbqjTCAQ/640?wx_fmt=png)image.png

##### 3.4.7ã€ è¯»å–é¡¹ç›®çš„ vite é…ç½®æ–‡ä»¶

```
constÂ projectDirectoryÂ =Â process.cwd();Â Â Â Â constÂ viteJsÂ =Â path.join(projectDirectory,Â 'vite.config.js');Â Â constÂ viteTsÂ =Â path.join(projectDirectory,Â 'vite.config.ts');Â Â constÂ viteMapÂ =Â {Â Â Â Â vue:Â viteJs,Â Â Â Â react:Â viteJs,Â Â Â Â 'vue-ts':Â viteTs,Â Â Â Â 'react-ts':Â viteTs,Â Â };Â Â constÂ viteFileÂ =Â viteMap[projectType];Â Â constÂ viteConfigÂ =Â viteEslint(fs.readFileSync(viteFile,Â 'utf8'));Â Â constÂ installCommandÂ =Â commandMap[packageManager];Â Â ifÂ (!installCommand)Â {Â Â Â Â console.log(chalk.red('\nâœ–Â Sorry,Â weÂ onlyÂ supportÂ npmÂ andÂ yarn!'));Â Â Â Â return;Â Â }
```

æ ¹æ®é€‰æ‹©çš„é¡¹ç›®ç±»å‹ï¼Œæ¥æ‹¼æ¥ vite.config çš„è·¯å¾„ï¼Œå¹¶è¯»å–é¡¹ç›®ä¸­çš„ vite.config é…ç½®æ–‡ä»¶

ä¸Šé¢ç”¨åˆ°äº†ä¸€ä¸ªå‡½æ•°`viteEslint`, è¿™ä¸ªå…·ä½“çš„å®ç°å¯ä»¥å»çœ‹`shared.js`ä¸­ï¼Œä¸»è¦å°±æ˜¯è¯»å–æ–‡ä»¶å†…å®¹åï¼Œä¼ å…¥çš„å‚æ•° codeï¼Œå°±æ˜¯`vite.config.ts`ä¸­çš„æ‰€æœ‰å­—ç¬¦

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJo9LNrVIcHBInyAHMYnGaicT4CI5J6ZXTwM3HEiaxQyCEH827EwFwdbSdg/640?wx_fmt=png)é€šè¿‡ babel çš„`parseSync`è½¬æ¢ä¸º astã€‚ast å¯¹è±¡å¦‚ä¸‹å›¾æ‰€ç¤º

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJoVZqzwa75lc88b2XhATkibQkvjlvf1aP4kAiceN2D8P0xWT5TnLo9goRA/640?wx_fmt=png)1656558646620.png

å¯¹ ast æ•°æ®è¿›è¡Œäº†ä¸€ç³»åˆ—çš„å¤„ç†åï¼Œå†é€šè¿‡`babel`çš„`transformFromAstSync`å°† ast è½¬æ¢ä¸ºä»£ç å­—ç¬¦ä¸²ã€‚

> å¯¹äº babel å¤„ç†è¿™ä¸€å—æˆ‘ä¹Ÿä¸å¤ªäº†è§£ï¼Œæœ‰æ—¶é—´æˆ‘å¾—å»åŠ ä¸€ä¸‹é¤ï¼Œå…·ä½“çš„å¯ä»¥å‚è€ƒ https://juejin.cn/post/6844904008679686152

##### 3.4.8 æ‰§è¡Œå‘½ä»¤ã€æ‰§è¡Œå®Œå°† eslint å’Œ prettier é…ç½®é‡å†™

```
constÂ spinnerÂ =Â createSpinner('InstallingÂ packages...').start();Â Â exec(`${commandMap[packageManager]}`,Â {Â cwd:Â projectDirectoryÂ },Â (error)Â =>Â {Â Â Â Â ifÂ (error)Â {Â Â Â Â Â Â spinner.error({Â Â Â Â Â Â Â Â text:Â chalk.bold.red('FailedÂ toÂ installÂ packages!'),Â Â Â Â Â Â Â Â mark:Â 'âœ–',Â Â Â Â Â Â });Â Â Â Â Â Â console.error(error);Â Â Â Â Â Â return;Â Â Â Â }Â Â Â Â constÂ eslintFileÂ =Â path.join(projectDirectory,Â '.eslintrc.json');Â Â Â Â constÂ prettierFileÂ =Â path.join(projectDirectory,Â '.prettierrc.json');Â Â Â Â constÂ eslintIgnoreFileÂ =Â path.join(projectDirectory,Â '.eslintignore');Â Â Â Â fs.writeFileSync(eslintFile,Â JSON.stringify(eslint,Â null,Â 2));Â Â Â Â fs.writeFileSync(prettierFile,Â JSON.stringify(prettierConfig,Â null,Â 2));Â Â Â Â fs.writeFileSync(eslintIgnoreFile,Â eslintIgnore.join('\n'));Â Â Â Â fs.writeFileSync(viteFile,Â viteConfig);Â Â Â Â spinner.success({Â text:Â chalk.bold.green('AllÂ done!Â ğŸ‰'),Â mark:Â 'âœ”'Â });Â Â Â Â console.log(Â Â Â Â Â Â chalk.bold.cyan('\nğŸ”¥Â ReloadÂ yourÂ editorÂ toÂ activateÂ theÂ settings!')Â Â Â Â );Â Â });
```

é¦–å…ˆé€šè¿‡`createSpinner`æ¥åˆ›å»ºä¸€ä¸ªå‘½ä»¤è¡Œä¸­çš„åŠ è½½ï¼Œç„¶åé€šè¿‡`child_process`ä¸­çš„`exec`æ¥æ‰§è¡Œ`[3.4.6]`ä¸­ç”Ÿæˆçš„å‘½ä»¤ï¼Œå»å®‰è£…ä¾èµ–å¹¶è¿›è¡Œç­‰å¾…ã€‚

å¦‚æœå‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œåˆ™é€šè¿‡`fs.writeFileSync`å°†ç”Ÿæˆçš„æ•°æ®å†™å…¥åˆ°ä¸‰ä¸ªæ–‡ä»¶å½“ä¸­`.eslintrc.json`ã€`.prettierrc.json`ã€`.eslintignore`ã€`vite.config.xx`ã€‚

4ã€npm initã€npx
--------------

å°è±¡é‡Œé¢å¤§å®¶å¯èƒ½å¯¹å®ƒçš„è®°å¿†å¯èƒ½éƒ½åœç•™åœ¨ï¼Œ`npm init`ä¹‹åæ˜¯å¿«é€Ÿçš„åˆå§‹åŒ–`package.json`, å¹¶é€šè¿‡äº¤äº’å¼çš„å‘½ä»¤è¡Œè®©æˆ‘ä»¬è¾“å…¥éœ€è¦çš„å­—æ®µå€¼ï¼Œå½“ç„¶å¦‚æœæƒ³ç›´æ¥ä½¿ç”¨é»˜è®¤å€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨`npm init -y`ã€‚

`create-app-react`åˆ›å»ºé¡¹ç›®å‘½ä»¤, å®˜ç½‘é“¾æ¥å¯ä»¥ç›´æ¥æŸ¥çœ‹ https://create-react-app.dev/docs/getting-started

```
//å®˜ç½‘çš„ä¸‰ç§å‘½ä»¤npxÂ create-react-appÂ my-appnpmÂ initÂ react-appÂ my-appyarnÂ createÂ react-appÂ my-app//æˆ‘åˆå‘ç°npmÂ createä¹Ÿæ˜¯å¯ä»¥çš„npmÂ createÂ react-appÂ my-app
```

ä¸Šè¿°è¿™äº›å‘½ä»¤æœ€ç»ˆæ•ˆæœéƒ½æ˜¯å¯ä»¥æ‰§è¡Œåˆ›å»ºé¡¹ç›®çš„

åŒæ ·çš„`vite`åˆ›å»ºé¡¹ç›®çš„å‘½ä»¤

```
//å®˜ç½‘çš„å‘½ä»¤npmÂ createÂ vite@latestyarnÂ createÂ vitepnpmÂ createÂ vite//Â æŒ‡å®šå…·ä½“æ¨¡æ¿çš„//Â npmÂ 6.xÂ npmÂ createÂ vite@latestÂ my-vue-appÂ --templateÂ vueÂ //npmÂ 7+,Â extraÂ double-dashÂ isÂ needed:Â npmÂ createÂ vite@latestÂ my-vue-appÂ --Â --templateÂ vueyarnÂ createÂ viteÂ my-vue-appÂ --templateÂ vuepnpmÂ createÂ viteÂ my-vue-appÂ --templateÂ vue
```

å¯ä»¥å‘ç°`vite`å®˜ç½‘æ²¡æœ‰ä½¿ç”¨`npx`å‘½ä»¤ï¼Œä¸è¿‡æˆ‘åœ¨æˆ‘è‡ªå·±ç”µè„‘ä¸Šå°è¯•äº†å¦å¤–å‡ ä¸ªå‘½ä»¤ç¡®å®ä¹Ÿæ˜¯å¯ä»¥çš„

```
npxÂ create-viteÂ my-app
npmÂ initÂ viteÂ my-app
```

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJotyNDmzGtbehQCJXSPcGz2uWo8icj2lKnJ0FiaTQ56yexUMTjG4405tJA/640?wx_fmt=png)image.png

é€šè¿‡ä¸Šé¢çš„å¯¹æ¯”å¯ä»¥ä¸€ä¸ªå°é—®é¢˜,`yarn create`å»å®˜ç½‘æŸ¥äº†æ˜¯å­˜åœ¨è¿™ä¸ªæŒ‡ä»¤çš„ï¼Œå®˜ç½‘åœ°å€å¯çœ‹ https://classic.yarnpkg.com/en/docs/cli/create#search

è€Œå¯¹äº`npm create`è¿™ä¸ªå‘½ä»¤åœ¨ npm å®˜ç½‘æ˜¯çœ‹ä¸åˆ°çš„ï¼Œä½†æ˜¯åœ¨ä¸€ç¯‡åšå®¢ä¸­å‘ç°äº†æ›´æ–°æ—¥å¿—

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJoQkqwl7nwAibRCUVff4Er7pAwyzvX9beaV086q0tpicibASa76YWj0PGUw/640?wx_fmt=png)image.png

æ„æ€å°±æ˜¯è¯´`npm create xxx`å’Œ`npm init xxx` ä»¥åŠ`yarn create xxx`æ•ˆæœæ˜¯ä¸€è‡´çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥æœ¬æ–‡çš„å‘½ä»¤è¡Œ

```
//Â æˆ‘ä»¬æ˜¯é€šè¿‡npmå®‰è£…çš„ï¼Œå¹¶ä¸”åŒ…åé‡Œæ˜¯åŒ…å«createçš„npmÂ iÂ create-vite-pretty-lint//Â é‚£ä¹ˆä»¥ä¸‹å‡ ç§æ–¹å¼éƒ½å¯ä»¥ä½¿ç”¨çš„npmÂ initÂ vite-pretty-lintnpmÂ createÂ vite-pretty-lintyarnÂ createÂ vite-pretty-lintnpxÂ create-vite-pretty-lint
```

**å†æ¥çœ‹ä¸€ä¸‹ npx**

å‡å¦‚æˆ‘ä»¬åªåœ¨é¡¹ç›®ä¸­å®‰è£…äº†`vite`, é‚£ä¹ˆ`node_modules`ä¸­`.bin`æ–‡ä»¶å¤¹ä¸‹æ˜¯ä¼šå­˜åœ¨`vite`æŒ‡ä»¤çš„

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJoFDCYxtmsxiazxUvDPmuxc7miatqonOwIicVBL6703Wg61GWMMvnTV5gag/640?wx_fmt=png)image.png

å¦‚æœæˆ‘ä»¬æƒ³åœ¨è¯¥é¡¹ç›®ä¸‹æ‰§è¡Œè¯¥å‘½ä»¤ç¬¬ä¸€ç§æ–¹å¼ä¾¿æ˜¯

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJop6pLh42rjhHic5Q32UWDkBJE9lErCicdDIPLCNQnxKvSYIRwDxnYctjw/640?wx_fmt=png)image.png

ç¬¬äºŒç§æ–¹å¼å°±æ˜¯ç›´æ¥åœ¨ package.json çš„ scripts å±æ€§ä¸‹

![](https://mmbiz.qpic.cn/mmbiz_png/Mpt86EGjlpuHoGia1Lq989bvNcnHFVQJoQnsA4P2DJWbOfyMQFyexg8L8RZEgUVnMcdyz9TgicRiaj0EpuL79ibA9g/640?wx_fmt=png)image.png

å…³äº npx çš„è¯¦ç»†è¯´æ˜å¯ä»¥çœ‹ä¸€ä¸‹é˜®ä¸€å³°å¤§ä½¬çš„ç²¾å½©åˆ†äº« http://www.ruanyifeng.com/blog/2019/02/npx.html

5ã€æ€»ç»“
----

*   npm init xxx çš„å¦™ç”¨, ä»¥åŠå¯¹ npx çš„äº†è§£ï¼Œæ„Ÿè§‰å¯¹ package.json çš„æ¯ä¸€ä¸ªå±æ€§ï¼Œå¯ä»¥ä¸“é—¨å»å­¦ä¹ ä¸€ä¸‹
    
*   å¯¹äºè‡ªåŠ¨æ·»åŠ  eslint å’Œ prettier é…ç½®çš„åŸç†åˆ†æ
    
*   .eslintrc.jsonã€.eslintignoreã€.prettierrc.json ç®—æ˜¯ç›´æ¥æ–°å¢æ–‡ä»¶ï¼Œå¤„ç†ç›¸å¯¹ç®€å•ä¸€äº›
    
*   æœ€é‡è¦çš„å­¦ä¹ ç‚¹ï¼šå¯¹ vite.config æ–‡ä»¶åœ¨åŸæœ‰åŸºç¡€ä¸Šçš„ä¿®æ”¹ï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°äº† AST æŠ½è±¡è¯­æ³•æ ‘